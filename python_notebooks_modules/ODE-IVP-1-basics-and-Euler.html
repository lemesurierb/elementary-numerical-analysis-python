
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>21. Solving Initial Value Problems for Ordinary Differential Equations, Part 1: Basic Concepts and Euler’s Method &#8212; Elementary Numerical Analysis (with Python)</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="22. Solving Initial Value Problems for ODEs, Part 2: Runge-Kutta Methods" href="ODE-IVP-2-Runge-Kutta.html" />
    <link rel="prev" title="20. Definite Integrals, Part 4: Romberg Integration — Preliminary Version" href="definite-integrals-4-romberg-integration.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/UNC_BearMascot.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Elementary Numerical Analysis (with Python)</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../preface.html">
   Elementary Numerical Analysis with Python
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Frontmatter
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Numerical Analysis
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-by-interval-halving.html">
   1. Root Finding by Interval Halving (Bisection)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fixed-point-iteration.html">
   2. Solving Equations by Fixed Point Iteration (of Contraction Mappings)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newtons-method.html">
   3. Newton’s Method for Solving Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="taylors-theorem.html">
   4. Taylor’s Theorem and the Accuracy of Linearization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error-measures-convergence-rates.html">
   5. Measures of Error and Order of Convergence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="convergence-rate-of-newtons-method.html">
   6. The Convergence Rate of Newton’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-without-derivatives.html">
   7. Root-finding Without Derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-1-row-reduction.html">
   8. Solving Simultaneous Linear Equations, Part 1: Row Reduction/Gaussian Elimination
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="machine-numbers-rounding-error-and-error-propagation.html">
   9. Machine Numbers, Rounding Error and Error Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-2-pivoting.html">
   10. Solving Simultaneous Linear Equations, Part 2: Partial Pivoting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-3-lu-factorization.html">
   11. Solving
   <span class="math notranslate nohighlight">
    \(Ax = b\)
   </span>
   with LU factorization,
   <span class="math notranslate nohighlight">
    \(A = L U\)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-4-plu-factorization.html">
   12. Solving
   <span class="math notranslate nohighlight">
    \(Ax = b\)
   </span>
   With Both Pivoting and LU factorization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polynomial-collocation%2Bapproximation.html">
   13. Polynomial Collocation (Interpolation/Extrapolation) and Approximation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polynomial-collocation-error-formulas.html">
   14. Error Formulas for Polynomial Collocation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="derivatives-and-the-method-of-undetermined-coefficents.html">
   15. Approximating Derivatives by the Method of Undetermined Coefficients
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="richardson-extrapolation.html">
   16. Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-1-building-blocks.html">
   17. Definite Integrals, Part 1: The Building Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-2-composite-rules.html">
   18. Definite Integrals, Part 2: The Composite Trapezoid and Midpoint Rules
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-3-simpson-richardson.html">
   19. Definite Integrals, Part 3: The (Composite) Simpson’s Rule and Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-4-romberg-integration.html">
   20. Definite Integrals, Part 4: Romberg Integration — Preliminary Version
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   21. Solving Initial Value Problems for Ordinary Differential Equations, Part 1: Basic Concepts and Euler’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-2-Runge-Kutta.html">
   22. Solving Initial Value Problems for ODEs, Part 2: Runge-Kutta Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-comparison-of-methods.html">
   23. Comparison of Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../future_topics.html">
   24. Some Future Topics
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Exercises
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/root-finding-by-interval-halving-exercises.html">
   Exercises on the Bisection Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/fixed-point-iteration-exercises.html">
   Exercises on Fixed Point Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/error-measures-convergence-rates-exercises.html">
   Exercises on Error Measures and Convergence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/newtons-method-exercises.html">
   Exercises on Newton’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/root-finding-without-derivatives-exercises.html">
   Exercises on Root-finding Without Derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/machine-numbers-rounding-error-and-error-propagation-exercises.html">
   Exercises on Machine Numbers, Rounding Error and Error Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/simultaneous-linear-equations-exercises.html">
   Exercises on Solving Simultaneous Linear Equations
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/MATH375-assignment1.html">
   MATH 375 Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/MATH375-assignment2.html">
   MATH 375 Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/MATH375-assignment3.html">
   MATH 375 Assignment 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root_finding.html">
   Module root_finding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/MATH375-assignment4.html">
   MATH 375 Assignment 4
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Preliminary Versions of Future Sections
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../preliminary_versions/introduction.html">
   1. Introduction to
   <em>
    Preliminary Versions
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-5-error-bounds-condition-numbers.html">
   2. Error bounds for linear algebra: condition numbers, matrix norms, etc. — Preliminary Version
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Python and Jupyter Notebook Review (with Numpy and Matplotlib)
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/introduction.html">
   1. Introduction to
   <em>
    Python Preview
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/getting-python-software-for-scientific-computing.html">
   2. Getting Python Software for Scientific Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/suggestions-on-python-and-notebook-usage.html">
   3. Suggestions and Notes on Python and Jupyter Notebook Usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/python-variables-lists-tuples-numpy-arrays.html">
   4. Python Variables, Including Lists and Tuples, and Arrays from Package Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/functions.html">
   5. Defining and Using Python Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/decisions-with-if-else-elif.html">
   6. Decision Making With if, else, and elif
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/iteration-with-for.html">
   7. Iteration with
   <code class="docutils literal notranslate">
    <span class="pre">
     for
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/iteration-with-while.html">
   8. Iteration with
   <code class="docutils literal notranslate">
    <span class="pre">
     while
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/code-files-modules-IDEs.html">
   9. Code Files, Modules, and an Integrated Development Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/recursion.html">
   10. Recursion (vs iteration)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/graphing-with-matplotlib.html">
   11. Plotting Graphs with Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/array-operations-and-linear-algebra.html">
   12. Numpy Array Operations and Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/scipy-tools-for-linear-algebra.html">
   13. Package Scipy and More Tools for Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/summation-and-integration.html">
   14. Summation and Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/random-numbers-and-simulation.html">
   15. Random Numbers, Histograms, and a Simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/formatted-output-and-some-text-string-manipulation.html">
   16. Formatted Output and Some Text String Manipulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/classes-objects-attributes-methods.html">
   17. Classes, Objects, Attributes, Methods: Very Basic Object-Oriented Programming in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/exception-handling.html">
   18. Exceptions and Exception Handling
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="numerical_methods_module.html">
   Notebook for generating the module
   <code class="docutils literal notranslate">
    <span class="pre">
     numerical_methods_module
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendices/linear-algebra-with-0-based-indexing-and-semiopen-intervals.html">
   Linear algebra algorithms using 0-based indexing and semi-open intervals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sample-project-newtons-method-draft.html">
   Numerical Analysis Sample Project on Newtons’s Method
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/python_notebooks_modules/ODE-IVP-1-basics-and-Euler.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/python_notebooks_modules/ODE-IVP-1-basics-and-Euler.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-basic-ode-initial-value-problem">
   21.1. The Basic ODE Initial Value Problem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notation-for-the-solution-of-an-initial-value-problem">
     21.1.1. Notation for the solution of an initial value problem
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#three-examples-plus-one-more">
   21.2. Three Examples (plus one more)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1-integration">
     21.2.1. Example 1: Integration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2-the-simplest-real-ode">
     21.2.2. Example 2: The simplest “real” ODE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-3-a-nonlinear-equation-with-failure-of-solutions">
     21.2.3. Example 3: A nonlinear equation, with failure of solutions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-4-added-march-22-a-stiff-equation-with-disparate-time-scales">
     21.2.4. Example 4 (Added March 22): A “stiff” equation with disparate time scales
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-tangent-line-method-a-k-a-euler-s-method">
   21.3. The Tangent Line Method, a.k.a. Euler’s Method
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1">
     21.3.1. Exercise 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-for-example-1-an-integration">
     21.3.2. Solving for Example 1: an integration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-for-example-2-some-exponential-functions">
     21.3.3. Solving for Example 2: some exponential functions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-for-example-3-solutions-that-blow-up">
     21.3.4. Solving for Example 3; solutions that blow up
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-for-example-4-added-march-22">
     21.3.5. Solving for Example 4 (Added March 22)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variable-time-step-sizes-h-i-just-a-preview-for-now">
     21.3.6. Variable Time Step Sizes
     <span class="math notranslate nohighlight">
      \(h_i\)
     </span>
     (just a preview for now)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#error-analysis-for-the-canonical-test-case-u-k-u">
     21.3.7. Error Analysis for the Canonical Test Case,
     <span class="math notranslate nohighlight">
      \(u' = k u\)
     </span>
     .
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#global-error-and-local-truncation-error">
     21.3.8. Global Error and Local (Truncation) Error
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#error-propagation-in-u-k-u-k-geq-0">
     21.3.9. Error propagation in
     <span class="math notranslate nohighlight">
      \(u' = k u\)
     </span>
     ,
     <span class="math notranslate nohighlight">
      \(k \geq 0\)
     </span>
     .
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bounding-the-local-truncation-errors">
     21.3.10. Bounding the local truncation errors …
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#and-using-this-to-complete-the-bound-on-the-global-truncation-error">
     21.3.11. … and using this to complete the bound on the global truncation error
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-more-general-error-bound-exists">
     21.3.12. A more general error bound exists
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#there-is-much-room-for-improvement">
     21.3.13. There is much room for improvement
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#error-propagation-for-example-1-an-integration">
     21.3.14. Error propagation for Example 1, an integration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#error-propagation-for-example-2">
     21.3.15. Error propagation for Example 2
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="solving-initial-value-problems-for-ordinary-differential-equations-part-1-basic-concepts-and-euler-s-method">
<h1><span class="section-number">21. </span>Solving Initial Value Problems for Ordinary Differential Equations, Part 1: Basic Concepts and Euler’s Method<a class="headerlink" href="#solving-initial-value-problems-for-ordinary-differential-equations-part-1-basic-concepts-and-euler-s-method" title="Permalink to this headline">¶</a></h1>
<p><strong>Updated on March 22</strong>
with added <a class="reference external" href="#example-4">Example 4</a> and some <a class="reference external" href="#solving-example-4">numerical solutions of it</a>.</p>
<p><strong>References:</strong></p>
<ul class="simple">
<li><p>Sections 6.1.1, 6.2.1, and 6.2.2 of <a class="reference external" href="../references.html#Sauer">Sauer</a></p></li>
<li><p>Section 5.2 of <a class="reference external" href="../references.html#Burden-Faires">Burden&amp;Faires</a></p></li>
<li><p>Sections 7.1 and 7.2 of <a class="reference external" href="../references.html#Chenney-Kincaid">Chenney&amp;Kincaid</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="c1"># Shortcuts for some favorite commands:</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linspace</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">legend</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-basic-ode-initial-value-problem">
<h2><span class="section-number">21.1. </span>The Basic ODE Initial Value Problem<a class="headerlink" href="#the-basic-ode-initial-value-problem" title="Permalink to this headline">¶</a></h2>
<p>We consider the problem of solving (approximately) the ordinary differential equation</p>
<div class="math notranslate nohighlight">
\[\frac{du}{dt} = f(t, u(t)), a \leq t \leq b\]</div>
<p>with the <em>initial condition</em></p>
<div class="math notranslate nohighlight">
\[u(a) = u_0\]</div>
<p>I will follow the common custom of referring to the independent variable as “time”.</p>
<p>For now, <span class="math notranslate nohighlight">\(u(t)\)</span> is real-valued, but little will change when we later let it be vector-valued (and/or complex-valued).</p>
<p><a name="IVP_notation"></a></p>
<div class="section" id="notation-for-the-solution-of-an-initial-value-problem">
<h3><span class="section-number">21.1.1. </span>Notation for the solution of an initial value problem<a class="headerlink" href="#notation-for-the-solution-of-an-initial-value-problem" title="Permalink to this headline">¶</a></h3>
<p>Sometimes, we need to be more careful and explicit in describing the function that solves the above initial value problem;
then the input <em>parameters</em> <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(u_0 = u(a)\)</span> will be included of the function’s formula:</p>
<div class="math notranslate nohighlight">
\[u(t) = u(t; a, u_0)\]</div>
<p>(It is standard mathematical convention to separate <em>parameters</em> like <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(u_0\)</span> from <em>variables</em> like <span class="math notranslate nohighlight">\(t\)</span> by putting the former after a semicolon.</p>
</div>
</div>
<div class="section" id="three-examples-plus-one-more">
<h2><span class="section-number">21.2. </span>Three Examples (plus one more)<a class="headerlink" href="#three-examples-plus-one-more" title="Permalink to this headline">¶</a></h2>
<p>A lot of useful intuition comes from three simple examples:</p>
<p><a name="example-1"></a></p>
<div class="section" id="example-1-integration">
<h3><span class="section-number">21.2.1. </span>Example 1: Integration<a class="headerlink" href="#example-1-integration" title="Permalink to this headline">¶</a></h3>
<p>If the derivative depends only on the independent variable <span class="math notranslate nohighlight">\(t\)</span>, so that</p>
<div class="math notranslate nohighlight">
\[
\frac{du}{dt} = f(t), a \leq t \leq b
\]</div>
<p>the solution is given by integration:</p>
<div class="math notranslate nohighlight">
\[
u(t) = u_0 + \int_a^t f(s)\, ds.
\]</div>
<p>In particular, with <span class="math notranslate nohighlight">\(u_0 = 0\)</span> the value at <span class="math notranslate nohighlight">\(b\)</span> is</p>
<div class="math notranslate nohighlight">
\[
u(t) = \int_a^b f(t)\, dt,
\]</div>
<p>and this gives us a back-door way to use numerical methods for solving ODEs to evaluate definite integrals.</p>
<p><a name="example-2"></a></p>
</div>
<div class="section" id="example-2-the-simplest-real-ode">
<h3><span class="section-number">21.2.2. </span>Example 2: The simplest “real” ODE<a class="headerlink" href="#example-2-the-simplest-real-ode" title="Permalink to this headline">¶</a></h3>
<p>The simplest case with <span class="math notranslate nohighlight">\(u\)</span> present in <span class="math notranslate nohighlight">\(f\)</span> is <span class="math notranslate nohighlight">\(f(t, u) = f(u) = u\)</span>.
But it does not hurt to add a constant, so:</p>
<div class="math notranslate nohighlight">
\[ \frac{du}{dt} = k u,\; k \text{ a constant.} \]</div>
<p>The solution is</p>
<div class="math notranslate nohighlight">
\[ u(t) = u_0 e^{kt} \]</div>
<p>We will see that this simple example contains the essence of ideas relevant far more generally.</p>
<p><a name="example-3"></a></p>
</div>
<div class="section" id="example-3-a-nonlinear-equation-with-failure-of-solutions">
<h3><span class="section-number">21.2.3. </span>Example 3: A nonlinear equation, with failure of solutions<a class="headerlink" href="#example-3-a-nonlinear-equation-with-failure-of-solutions" title="Permalink to this headline">¶</a></h3>
<p>In the previous examples, <span class="math notranslate nohighlight">\(f(t, u)\)</span> is linear in <span class="math notranslate nohighlight">\(u\)</span> (consider <span class="math notranslate nohighlight">\(t\)</span> as fixed);
nonlinearities can lead to more difficult behavior.
The equation</p>
<div class="math notranslate nohighlight">
\[ \frac{du}{dt} = u^2, \, u(a) = u_0 \]</div>
<p>can be solved by separation of variables — or for now you can just verify the solution</p>
<div class="math notranslate nohighlight">
\[ u(t) = \frac{1}{T - t}, \, T = a + 1/u_0. \]</div>
<p>Note that if <span class="math notranslate nohighlight">\(u_0 &gt; 0\)</span>, the only exists for <span class="math notranslate nohighlight">\(t &lt; T\)</span>.
(The solution is also valid for <span class="math notranslate nohighlight">\(T &gt; 0\)</span>, but that part has no connection to the initial data at <span class="math notranslate nohighlight">\(t=a\)</span>.)</p>
<p>Example 3 warns us that the IVP might not be <strong>well-posed</strong> when we set the interval <span class="math notranslate nohighlight">\([a, b]\)</span> in advance: all we can guarantee in general is that a solution exists up to some time <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(b &gt; a\)</span>.</p>
<p><a name="example-4"></a></p>
</div>
<div class="section" id="example-4-added-march-22-a-stiff-equation-with-disparate-time-scales">
<h3><span class="section-number">21.2.4. </span>Example 4 (Added March 22): A “stiff” equation with disparate time scales<a class="headerlink" href="#example-4-added-march-22-a-stiff-equation-with-disparate-time-scales" title="Permalink to this headline">¶</a></h3>
<p>One common problem in practical situations is differential equations where some phenomena happen on a very fast time scale, but only ever at very small amplitudes, so they have very little relevance to the overall solution.
One example is decriptions of some chemical reactions, where some reaction products (like free radicals) are producd in tiny quantities and break down very rapidly, so they change on a very fast time scale but are scarcely relevant to the overall solution.</p>
<p>This disparity of time-sales is called <em>stiffness</em>, from the analogy of a mechanical system in which some components are very stiff and so vibrate at very high frequencies, but typically only at very small amplitudes, or very quicky damped away, so that they can often be safely described by assuming that those stiff parts are completely rigid — do not move at all.</p>
<p>One equation that illustrates this feature is</p>
<div class="math notranslate nohighlight">
\[
\frac{du}{dt} = -\sin t -K(u - \cos t) 
\]</div>
<p>where <span class="math notranslate nohighlight">\(K\)</span> is large and positive.
Its family of solutions is</p>
<div class="math notranslate nohighlight">
\[
u(t) = \cos t + c e^{-K t}
\]</div>
<p>with <span class="math notranslate nohighlight">\(c = u_0 - 1\)</span> for the initial value problem <span class="math notranslate nohighlight">\(u(0) = u_0\)</span>.</p>
<p>These all get close to <span class="math notranslate nohighlight">\(\cos t\)</span> quickly and then stay nearby, but with a rapid and rapidly decaying “transient” <span class="math notranslate nohighlight">\(c e^{-K t}\)</span>.</p>
<p>Many of the most basic and widely use numerical methods (including Euler’s Method thet we meet soon) need to use very small time steps to handle that fast transient, even when it is very small because <span class="math notranslate nohighlight">\(u_0 \approx 1\)</span>.</p>
<p>On the other hand there are methods that “supress” these transients, allowing use of larger time steps while still getting an accurate description of the main, slower, phenomena.
The simplest of these is the <em>Backward Euler Method</em> that we will see in a later section.</p>
</div>
</div>
<div class="section" id="the-tangent-line-method-a-k-a-euler-s-method">
<h2><span class="section-number">21.3. </span>The Tangent Line Method, a.k.a. Euler’s Method<a class="headerlink" href="#the-tangent-line-method-a-k-a-euler-s-method" title="Permalink to this headline">¶</a></h2>
<p>Once we know <span class="math notranslate nohighlight">\(u(t)\)</span> (or a good approximation) at some time <span class="math notranslate nohighlight">\(t\)</span>, we also know the value of <span class="math notranslate nohighlight">\(u'(t) = f(t, u(t))\)</span> there; in particular, we know that <span class="math notranslate nohighlight">\(u(a) = u_0\)</span> and so <span class="math notranslate nohighlight">\(u'(a) = f(a, u_0)\)</span>.</p>
<p>This allows us to approximate <span class="math notranslate nohighlight">\(u\)</span> for slightly larger values of the argument (which I will call “time”) using its tangent line:</p>
<div class="math notranslate nohighlight">
\[ u(a+h) \approx u(a) + u'(a) h = u_0 + f(a, u_0) h  \text{ for &quot;small&quot; $h$} \]</div>
<p>and more generally</p>
<div class="math notranslate nohighlight">
\[ u(t+h) \approx u(t) + f(t, u(t)) h \text{ for &quot;small&quot; $h$} \]</div>
<p>This leads to the simplest approximation: choose a step size <span class="math notranslate nohighlight">\(h\)</span> determining equally spaced times <span class="math notranslate nohighlight">\(t_i = a + i h\)</span> and define — recursively — a sequence of approximations <span class="math notranslate nohighlight">\(U_i \approx u(t_i)\)</span> with</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
U_0 &amp;= u_0
\\
U_{i+1} &amp;= U_i + h f(t_i, U_i))
\end{split}\end{split}\]</div>
<p>If we choose a number of time steps <span class="math notranslate nohighlight">\(n\)</span> and set <span class="math notranslate nohighlight">\(h = (b-a)/n\)</span> for <span class="math notranslate nohighlight">\(0 \leq i \leq n\)</span>,
the second equation is needed for <span class="math notranslate nohighlight">\(0 \leq i &lt; n\)</span>, ending with <span class="math notranslate nohighlight">\(U_n \approx u(t_n) = u(b)\)</span>.</p>
<p>This “two-liner” do not need a pseudo-code description; instead, we can go directly to a rudimentary Python function for Euler’s Method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solve du/dt = f(t, u) for t in [a, b], with initial value u(a) = u_0&quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Note: &quot;n&quot; counts steps, so there are n+1 values for t.</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">h</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="exercise-1">
<h3><span class="section-number">21.3.1. </span>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h3>
<p>Show that for the integration case <span class="math notranslate nohighlight">\(f(t, u) = f(t)\)</span>, Euler’s Method is the same as the Composite Left-hand Endpoint Rule,
as in the section <a class="reference internal" href="definite-integrals-2-composite-rules.html"><span class="doc std std-doc">Definite Integrals, Part 2</span></a>.</p>
</div>
<div class="section" id="solving-for-example-1-an-integration">
<h3><span class="section-number">21.3.2. </span>Solving for <a class="reference external" href="#example-1">Example 1</a>: an integration<a class="headerlink" href="#solving-for-example-1-an-integration" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_1</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For integration of -sin(x): should get cos(x) + constant&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">u_0</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">n_steps</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Often enough for a nice graph.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n_steps</span><span class="p">)</span>  
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s2">&quot;This should look like $y = \cos(x)$&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact solution&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Euler&#39;s answer&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-1-basics-and-Euler_17_0.png" src="../_images/ODE-IVP-1-basics-and-Euler_17_0.png" />
</div>
</div>
</div>
<div class="section" id="solving-for-example-2-some-exponential-functions">
<h3><span class="section-number">21.3.3. </span>Solving for <a class="reference external" href="#example-2">Example 2</a>: some exponential functions<a class="headerlink" href="#solving-for-example-2-some-exponential-functions" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For solving du/dt = k u.</span>
<span class="sd">    The variable k may be defined later, so long as that is done before this function is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">k</span><span class="o">*</span><span class="n">u</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># You could experiment by changing these values here;</span>
<span class="c1"># for now I instead redefine them below.</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">u_0</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">n_steps</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>50
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n_steps</span><span class="p">)</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This should look like $u = </span><span class="si">{</span><span class="n">u_0</span><span class="si">}</span><span class="s2"> \, \exp(</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> \, t)$&quot;</span><span class="p">)</span>
<span class="c1">#u = u_0*np.exp(k*t)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact solution&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Euler&#39;s answer&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-1-basics-and-Euler_21_0.png" src="../_images/ODE-IVP-1-basics-and-Euler_21_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># You could experiment by changing these values here.</span>
<span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>
<span class="n">u_0</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">n_steps</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n_steps</span><span class="p">)</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This should look like $y = </span><span class="si">{</span><span class="n">u_0</span><span class="si">}</span><span class="s2"> \, \exp(</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> \, t)$&quot;</span><span class="p">)</span>
<span class="c1">#u = u_0*np.exp(k*t)</span>
<span class="n">u</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact solution&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Euler&#39;s answer&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-1-basics-and-Euler_23_0.png" src="../_images/ODE-IVP-1-basics-and-Euler_23_0.png" />
</div>
</div>
</div>
<div class="section" id="solving-for-example-3-solutions-that-blow-up">
<h3><span class="section-number">21.3.4. </span>Solving for <a class="reference external" href="#example-3">Example 3</a>; solutions that blow up<a class="headerlink" href="#solving-for-example-3-solutions-that-blow-up" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For solving du/dt = u^2.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">u</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">u_0</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_3</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">u_0</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This should look like $u = 1/(</span><span class="si">{</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">u_0</span><span class="si">}</span><span class="s2"> - t)$&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact solution&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Euler&#39;s answer&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-1-basics-and-Euler_27_0.png" src="../_images/ODE-IVP-1-basics-and-Euler_27_0.png" />
</div>
</div>
<p>There is clearly a problem when <span class="math notranslate nohighlight">\(t\)</span> reaches 1; let us explore that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="mf">1.1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_3</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">u_0</span>
<span class="n">t1000</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># More t values are needed to get a good graph near the vertical asymptote</span>
<span class="n">u</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">u_0</span> <span class="o">-</span> <span class="n">t1000</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This should look like $u = 1/(</span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2"> - t)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># Note: if you are curious about this new function &quot;ylim&quot;, uncomment the following:</span>
<span class="c1">#help(plt.ylim)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t1000</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact solution&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Euler&#39;s answer&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-1-basics-and-Euler_30_0.png" src="../_images/ODE-IVP-1-basics-and-Euler_30_0.png" />
</div>
</div>
<p>Clearly Euler’s method can never produce the vertical asymptote; even less can it get the jump to negative values of <span class="math notranslate nohighlight">\(u\)</span>.
The best we can do is improve accuracy by using more, smaller time steps:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">=</span><span class="mf">0.999</span>
<span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_3</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>  <span class="c1"># More t values, to improve accuracy</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">u_0</span>
<span class="n">t1000</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># More t values are needed to get a good graph near the vertical asymptote</span>
<span class="n">u</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">u_0</span> <span class="o">-</span> <span class="n">t1000</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This should look like $u = 1/(</span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2"> - t)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t1000</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact solution&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Euler&#39;s answer&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-1-basics-and-Euler_32_0.png" src="../_images/ODE-IVP-1-basics-and-Euler_32_0.png" />
</div>
</div>
<p><a name="solving-example-4"></a></p>
</div>
<div class="section" id="solving-for-example-4-added-march-22">
<h3><span class="section-number">21.3.5. </span>Solving for <a class="reference external" href="#example-4">Example 4</a> (Added March 22)<a class="headerlink" href="#solving-for-example-4-added-march-22" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_4</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The variable K may be defined later, so long as that is done before this function is used.</span>
<span class="sd">    The solution for a=0 is u(t) = u(t; 0, u_0) = \cos t + (u_0 - 1) e^{-K t}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>With enough steps (small enough step size <span class="math notranslate nohighlight">\(h\)</span>), all is well:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># One period</span>
<span class="n">u_0</span> <span class="o">=</span> <span class="mf">2.</span>
<span class="n">K</span> <span class="o">=</span> <span class="mf">40.</span>
<span class="n">n</span><span class="o">=</span><span class="mi">1000</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_4</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">u_0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">K</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> 
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This should look like u = cos t + </span><span class="si">{</span><span class="n">u_0</span><span class="o">-</span><span class="mi">1</span><span class="si">:</span><span class="s2">0.3</span><span class="si">}</span><span class="s2"> exp(-</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s2"> t)&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact solution&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Euler&#39;s answer with h=</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">0.3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-1-basics-and-Euler_37_0.png" src="../_images/ODE-IVP-1-basics-and-Euler_37_0.png" />
</div>
</div>
<p>However, with large steps (still small enough to handle the <span class="math notranslate nohighlight">\(\cos t\)</span> part), there is a catastrophic failure, with growing oscillations that, as we will see, are a characteristic feature of <em>instability</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_4</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">u_0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">K</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> 
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This should look like u = cos t + </span><span class="si">{</span><span class="n">u_0</span><span class="o">-</span><span class="mi">1</span><span class="si">:</span><span class="s2">0.3</span><span class="si">}</span><span class="s2"> exp(-</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s2"> t)&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact solution&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Euler&#39;s answer with h=</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">0.3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-1-basics-and-Euler_40_0.png" src="../_images/ODE-IVP-1-basics-and-Euler_40_0.png" />
</div>
</div>
<p>To show that the <span class="math notranslate nohighlight">\(K\)</span> part is the problem, reduce <span class="math notranslate nohighlight">\(K\)</span> while leaving the rest unchanged:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="mf">1.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_4</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">u_0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">K</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> 
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This should look like u = cos t + </span><span class="si">{</span><span class="n">u_0</span><span class="o">-</span><span class="mi">1</span><span class="si">:</span><span class="s2">0.3</span><span class="si">}</span><span class="s2"> exp(-</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s2"> t)&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact solution&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Euler&#39;s answer with h=</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">0.3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-1-basics-and-Euler_43_0.png" src="../_images/ODE-IVP-1-basics-and-Euler_43_0.png" />
</div>
</div>
</div>
<div class="section" id="variable-time-step-sizes-h-i-just-a-preview-for-now">
<h3><span class="section-number">21.3.6. </span>Variable Time Step Sizes <span class="math notranslate nohighlight">\(h_i\)</span> (just a preview for now)<a class="headerlink" href="#variable-time-step-sizes-h-i-just-a-preview-for-now" title="Permalink to this headline">¶</a></h3>
<p>It is sometime useful to adjust the time step size; for example reducing it when the derivative is larger,
(as happens in Example 3 above).
This gives a slight variant, now expressed in pseudo-code:</p>
<p>Input: <span class="math notranslate nohighlight">\(f\)</span>, <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(n\)</span> <br>
<span class="math notranslate nohighlight">\(t_0 = a\)</span> <br>
<span class="math notranslate nohighlight">\(U_0 = u_0\)</span> <br>
for i in <span class="math notranslate nohighlight">\([0, n)\)</span>: <br>
<span class="math notranslate nohighlight">\(\quad\)</span> Choose <span class="math notranslate nohighlight">\(h_i\)</span> somehow <br>
<span class="math notranslate nohighlight">\(\quad t_{i+1} = t_i + h_i\)</span> <br>
<span class="math notranslate nohighlight">\(\quad U_{i+1} = U_i + h_i f(t_i, U_i)\)</span> <br>
end for</p>
<p>In a later section, we will see how to estimate errors within an algorithm,
and then how to use such error estimates to guide the choice of step size.</p>
</div>
<div class="section" id="error-analysis-for-the-canonical-test-case-u-k-u">
<h3><span class="section-number">21.3.7. </span>Error Analysis for the Canonical Test Case, <span class="math notranslate nohighlight">\(u' = k u\)</span>.<a class="headerlink" href="#error-analysis-for-the-canonical-test-case-u-k-u" title="Permalink to this headline">¶</a></h3>
<p>A great amount of intuition about numerical methods for solving ODE IVPs comes from that “simplest nontrivial example”, number 2 above.
We can solve it with constant step size <span class="math notranslate nohighlight">\(h\)</span>, and thus study its errors and accuracy.
The recursion relation is now</p>
<div class="math notranslate nohighlight">
\[U_{i+1} = U_i + h k U_i = U_i (1 + hk),\]</div>
<p>with solution</p>
<div class="math notranslate nohighlight">
\[U_i = u_0 (1 + hk)^i.\]</div>
<p>For comparison, the exact solution of this ODE IVP is</p>
<div class="math notranslate nohighlight">
\[
u(t_i) = u_0 e^{k(t_i - a)} = u_0 e^{k ih} = u_0 (e^{kh})^i
\]</div>
<p>So each is a geometric series: the difference is that the <em>growth factor</em> is <span class="math notranslate nohighlight">\(G = (1 + hk)\)</span> for Euler’s method,
vs <span class="math notranslate nohighlight">\(g = e^{kh} = 1 + hk + (hk)^2/2 + \cdots = 1 + hk + O(h^2)\)</span> for the ODE.</p>
<p>Ths deviation at each time step is <span class="math notranslate nohighlight">\(O(h^2)\)</span>, suggesting that by the end <span class="math notranslate nohighlight">\(t=b\)</span>, at step <span class="math notranslate nohighlight">\(n\)</span>, the error will be <span class="math notranslate nohighlight">\(O(n h^2) = O\left(\displaystyle\frac{b-a}{h} h^2\right) = O(h)\)</span>.</p>
<p>This is in fact what happens, but to verify that, we must deal with the challenge that once an error enters at one step, it is potentially amplified at each subsequent step, so the errors introduced at each step do not simply get summed like they did with definite integrals.</p>
</div>
<div class="section" id="global-error-and-local-truncation-error">
<h3><span class="section-number">21.3.8. </span>Global Error and Local (Truncation) Error<a class="headerlink" href="#global-error-and-local-truncation-error" title="Permalink to this headline">¶</a></h3>
<p>Ultimately, the error we need to understand is the <strong>global error</strong>: at step <span class="math notranslate nohighlight">\(i\)</span>,</p>
<div class="math notranslate nohighlight">
\[ E_i = u(t_i) - U_i \]</div>
<p>We will approach this by first considering the new error added at each step, the <strong>local truncation error</strong> (or <strong>discretization error</strong>).</p>
<p>At the first step this is the same as above:</p>
<div class="math notranslate nohighlight">
\[ e_1 = u(t_1) - U_1 = u(a+h) - U_1 \]</div>
<p>However at later steps we compare the results <span class="math notranslate nohighlight">\(U_{i+1}\)</span> to what the solution would be if it were exact at the start of that step: that is, if <span class="math notranslate nohighlight">\(U_i\)</span> were exact.</p>
<p>Using the notation <span class="math notranslate nohighlight">\(u(t; t_i, U_i)\)</span> introduced <a href="#IVP_notation">above</a> for the solution of the ODE with initial condition <span class="math notranslate nohighlight">\(u(t_i) = U_i\)</span>, the <strong>location truncation error</strong> at step <span class="math notranslate nohighlight">\(i\)</span> is the discrepancy at time <span class="math notranslate nohighlight">\(t_{i+1}\)</span> between what Euler’s method and the exact solution give when both start at that point <span class="math notranslate nohighlight">\((t_i, U_i)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ e_i = u(t; t_i, U_i) - U_{i+1} \]</div>
</div>
<div class="section" id="error-propagation-in-u-k-u-k-geq-0">
<h3><span class="section-number">21.3.9. </span>Error propagation in <span class="math notranslate nohighlight">\(u' = k u\)</span>, <span class="math notranslate nohighlight">\(k \geq 0\)</span>.<a class="headerlink" href="#error-propagation-in-u-k-u-k-geq-0" title="Permalink to this headline">¶</a></h3>
<p>After one step, <span class="math notranslate nohighlight">\(E_1 = u(t_1) - U_1 = e_1\)</span>.</p>
<p>At step 2,</p>
<div class="math notranslate nohighlight">
\[ E_2 = u(t_2) - U_2 = (u(t_2) - u(t_2, t_1, U_1) + (u(t_2, t_1, U_1) - U_2)
= (u(t_2) - u(t_2, t_1, U_1) + e_2 \]</div>
<p>The first term is the difference at <span class="math notranslate nohighlight">\(t=t_2\)</span> of two solutions with values at <span class="math notranslate nohighlight">\(t = t_1\)</span> being <span class="math notranslate nohighlight">\(u(t_1)\)</span> and <span class="math notranslate nohighlight">\(U_1\)</span> respectively. As the ODE is linear and homogeneous, this is the solution of the same ODE with value at <span class="math notranslate nohighlight">\(t=t_1\)</span> being <span class="math notranslate nohighlight">\(u(t_1) - U_1\)</span>, which is <span class="math notranslate nohighlight">\(e_1\)</span>:
that solution is <span class="math notranslate nohighlight">\(e_1 e^{y(t - t_1}\)</span>, so at <span class="math notranslate nohighlight">\(t=t_2\)</span> it is <span class="math notranslate nohighlight">\(e_1 e^{kh}\)</span>.
Thus the global error after two steps is</p>
<div class="math notranslate nohighlight">
\[ E_2 = e_2 + (e^{kh})e_1: \]</div>
<p>the error from the previous step has been amplified by the growth factor <span class="math notranslate nohighlight">\(g = e^{kh}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ E_2 = e_2 + g e_1: \]</div>
<p>This continues, so that</p>
<div class="math notranslate nohighlight">
\[ E_3 = e_3 + g E_1 = e_3 + g (e_2 + g e_1) = e_3 + ge_2 + g^2 e_1 \]</div>
<p>and so on, leading to</p>
<p>$<span class="math notranslate nohighlight">\( E_i = e_i + g e_{i-1} + g^2 e_{i-2} + \cdots + g^{i-1} e_{1} \)</span>$.</p>
</div>
<div class="section" id="bounding-the-local-truncation-errors">
<h3><span class="section-number">21.3.10. </span>Bounding the local truncation errors …<a class="headerlink" href="#bounding-the-local-truncation-errors" title="Permalink to this headline">¶</a></h3>
<p>To get a bound on the global error from the formula above, we first need a bound on the local truncation errors <span class="math notranslate nohighlight">\(e_i\)</span>.</p>
<p>Taylor’s theorem gives <span class="math notranslate nohighlight">\(e^{kh} = 1 + kh + e^{k \xi} (kh)^2/2\)</span>, <span class="math notranslate nohighlight">\(0 &lt; \xi &lt; k h\)</span>, so</p>
<div class="math notranslate nohighlight">
\[
e_i = U_i e^{kh} - U_i (1 + kh) = U_i (e^{k \xi} h^2/2)
\]</div>
<p>and thus</p>
<div class="math notranslate nohighlight">
\[|e_i| \leq |U_i| \frac{e^{kh}}{2} h^2\]</div>
<p>Also, since <span class="math notranslate nohighlight">\(1 + kh &lt; e^{kh}\)</span>,
<span class="math notranslate nohighlight">\(|U_i| &lt; |u(t_i)| = |u_0| e^{k(t_i - a)},\)</span>
and we only need this to the beginning of the last step, <span class="math notranslate nohighlight">\(i \leq n-1\)</span>, for which</p>
<div class="math notranslate nohighlight">
\[
|U_i| &lt; |u_0| e^{k(b - h - a)}
\]</div>
<p>Thus</p>
<div class="math notranslate nohighlight">
\[
|e_i| \leq \frac{|u_0| e^{k(b - h - a)} e^{kh}}{2} h^2 = \frac{|u_0 e^{k(b - a)}|}{2} h^2
\]</div>
<p>That is,</p>
<div class="math notranslate nohighlight">
\[ |e_i| \leq C h^2 \text{ where } C := \frac{|u_0 e^{k(b - a)}|}{2} \]</div>
</div>
<div class="section" id="and-using-this-to-complete-the-bound-on-the-global-truncation-error">
<h3><span class="section-number">21.3.11. </span>… and using this to complete the bound on the global truncation error<a class="headerlink" href="#and-using-this-to-complete-the-bound-on-the-global-truncation-error" title="Permalink to this headline">¶</a></h3>
<p>Using this bound on tehlocal errors <span class="math notranslate nohighlight">\(e_i\)</span> in the above sum for the global error <span class="math notranslate nohighlight">\(E_i\)</span>,</p>
<div class="math notranslate nohighlight">
\[ | E_i | \leq C h^2 (1 + g + \cdots g^{i-1}) = C \frac{g^i - 1}{g-1} h^2 \]</div>
<p>Since <span class="math notranslate nohighlight">\(g^i = e^{k h i} = e^{k (t_i - a)}\)</span> and the denominator <span class="math notranslate nohighlight">\(g - 1 = e^{kh} - 1 &gt; k h\)</span>,
we get</p>
<div class="math notranslate nohighlight">
\[
| E_i | \leq  C \frac{e^{k (t_i - a)} - 1}{k h} h^2
\leq \frac{|u_0 e^{k(b - a)}|}{2} \frac{e^{k (t_i - a)} - 1}{k} h, = O(h)
\]</div>
<p>Note that this global error formula is bulilt from three factors:</p>
<ul class="simple">
<li><p>The first is the constant
<span class="math notranslate nohighlight">\(\displaystyle \frac{|u_0 e^{k(b - a)}|}{2}\)</span>
which is roughly half of the maximum value of the exact solution over the interval <span class="math notranslate nohighlight">\([a, b]\)</span>.</p></li>
<li><p>The second
<span class="math notranslate nohighlight">\(\displaystyle \frac{e^{k (t_i - a)} - 1}{k}\)</span>
depends on <span class="math notranslate nohighlight">\(t\)</span>, and</p></li>
<li><p>The third is <span class="math notranslate nohighlight">\(h\)</span>, showing the overall order of accuracy: first order: the overall absolute error is <span class="math notranslate nohighlight">\(O(h)\)</span>.</p></li>
</ul>
</div>
<div class="section" id="a-more-general-error-bound-exists">
<h3><span class="section-number">21.3.12. </span>A more general error bound exists<a class="headerlink" href="#a-more-general-error-bound-exists" title="Permalink to this headline">¶</a></h3>
<p>A very similar result applies to the solution <span class="math notranslate nohighlight">\(u(t; a, u_0)\)</span> of the more general initial value problem</p>
<div class="math notranslate nohighlight">
\[
\frac{du}{dt} = f(t, u), \quad u(a) = u_0
\]</div>
<p>so long as the function <span class="math notranslate nohighlight">\(f\)</span> is “somewhat well-behaved” in that it satisfies a so-called <em>Lipschitz Condition</em>:
that there is some constant <span class="math notranslate nohighlight">\(K\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
\left| \frac{\partial F}{\partial u}(t, u) \right| \leq K 
\]</div>
<p>for the relevant time values <span class="math notranslate nohighlight">\(a \leq t \leq b\)</span>.</p>
<p>Then this constant <span class="math notranslate nohighlight">\(K\)</span> plays the part of the exponential growth factor <span class="math notranslate nohighlight">\(k\)</span> above:</p>
<div class="math notranslate nohighlight">
\[
| E_i | \leq \frac{|u_0 e^{K(b - a)}|}{2} \frac{e^{K (t_i - a)} - 1}{k} h, = O(h)
\]</div>
<p><strong>Aside:</strong> As you might have seen in a course on differential equations, such a Lipschitz Condition is necessary to even guarantee that the initial value problem has a unique solution, so it is a quite reasonable requirement.</p>
</div>
<div class="section" id="there-is-much-room-for-improvement">
<h3><span class="section-number">21.3.13. </span>There is much room for improvement<a class="headerlink" href="#there-is-much-room-for-improvement" title="Permalink to this headline">¶</a></h3>
<p>As with definite integrals, this is not very impressive, so in the next section on
<a class="reference internal" href="ODE-IVP-2-Runge-Kutta.html"><span class="doc std std-doc">Runge-Kutta Methods</span></a>
we will explore several widely used methods that improve to second order and then fourth order accuracy.
Later, we will see how to get even higher orders.</p>
<p>But first, we can illustrate how this exponential growth of errors looks in some examples, and coapr the the better behaved errors in definite integrals.</p>
<p>This will be done by looking at the effect of a small change in the initial value, to simulate an error that arises there.</p>
</div>
<div class="section" id="error-propagation-for-example-1-an-integration">
<h3><span class="section-number">21.3.14. </span>Error propagation for <a class="reference external" href="#example-1">Example 1</a>, an integration<a class="headerlink" href="#error-propagation-for-example-1-an-integration" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">u_0</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Original value</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">)</span>  <span class="c1"># Use the default of 50 steps; typically enough for a nice graph.</span>
</pre></div>
</div>
</div>
</div>
<p>But now “perturb” the initial value in all cases by this much:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta_u_0</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u_perturbed</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="o">+</span><span class="n">delta_u_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s2">&quot;The solution before perturbing $u(0)$ was $u = \cos(x)$&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Original exact solution&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Euler&#39;s answer before perturbation&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u_perturbed</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Euler&#39;s answer after perturbation&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-1-basics-and-Euler_60_0.png" src="../_images/ODE-IVP-1-basics-and-Euler_60_0.png" />
</div>
</div>
<p>This just shifts all the <span class="math notranslate nohighlight">\(u\)</span> values up by the perturbation of <span class="math notranslate nohighlight">\(u_0\)</span>.</p>
</div>
<div class="section" id="error-propagation-for-example-2">
<h3><span class="section-number">21.3.15. </span>Error propagation for <a class="reference external" href="#example-2">Example 2</a><a class="headerlink" href="#error-propagation-for-example-2" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">u_0</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Original value</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">)</span>
<span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U_perturbed</span><span class="p">)</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f_2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="o">+</span><span class="n">delta_u_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s2">&quot;The solution before perturbing $u(0)$ was $u = </span><span class="si">{u_0}</span><span class="s2"> \, \exp(</span><span class="si">{k}</span><span class="s2"> \, t)$&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u_0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Original exact solution&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Euler&#39;s answer before perturbation&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U_perturbed</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Euler&#39;s answer after perturbation&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-1-basics-and-Euler_65_0.png" src="../_images/ODE-IVP-1-basics-and-Euler_65_0.png" />
</div>
</div>
<p>Graphing the error shows its exponential growth:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u_0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">U</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-1-basics-and-Euler_67_0.png" src="../_images/ODE-IVP-1-basics-and-Euler_67_0.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./python_notebooks_modules"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="definite-integrals-4-romberg-integration.html" title="previous page"><span class="section-number">20. </span>Definite Integrals, Part 4: Romberg Integration — Preliminary Version</a>
    <a class='right-next' id="next-link" href="ODE-IVP-2-Runge-Kutta.html" title="next page"><span class="section-number">22. </span>Solving Initial Value Problems for ODEs, Part 2: Runge-Kutta Methods</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Brenton LeMesurier, College of Charleston and University of Northern Colorado<br/>
        
            &copy; Copyright 2020–2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>