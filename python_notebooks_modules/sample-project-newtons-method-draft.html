
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Numerical Analysis Sample Project on Newtons’s Method &#8212; Elementary Numerical Analysis (with Python)</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Linear algebra algorithms using 0-based indexing and semi-open intervals" href="../appendices/linear-algebra-with-0-based-indexing-and-semiopen-intervals.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/UNC_BearMascot.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Elementary Numerical Analysis (with Python)</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../preface.html">
   Elementary Numerical Analysis with Python
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Frontmatter
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Numerical Analysis
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-by-interval-halving.html">
   1. Root Finding by Interval Halving (Bisection)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fixed-point-iteration.html">
   2. Solving Equations by Fixed Point Iteration (of Contraction Mappings)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newtons-method.html">
   3. Newton’s Method for Solving Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="taylors-theorem.html">
   4. Taylor’s Theorem and the Accuracy of Linearization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error-measures-convergence-rates.html">
   5. Measures of Error and Order of Convergence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="convergence-rate-of-newtons-method.html">
   6. The Convergence Rate of Newton’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-without-derivatives.html">
   7. Root-finding Without Derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-1-row-reduction.html">
   8. Solving Simultaneous Linear Equations, Part 1: Row Reduction/Gaussian Elimination
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="machine-numbers-rounding-error-and-error-propagation.html">
   9. Machine Numbers, Rounding Error and Error Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-2-pivoting.html">
   10. Solving Simultaneous Linear Equations, Part 2: Partial Pivoting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-3-lu-factorization.html">
   11. Solving
   <span class="math notranslate nohighlight">
    \(Ax = b\)
   </span>
   with LU factorization,
   <span class="math notranslate nohighlight">
    \(A = L U\)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-4-plu-factorization.html">
   12. Solving
   <span class="math notranslate nohighlight">
    \(Ax = b\)
   </span>
   With Both Pivoting and LU factorization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polynomial-collocation%2Bapproximation.html">
   13. Polynomial Collocation (Interpolation/Extrapolation) and Approximation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polynomial-collocation-error-formulas.html">
   14. Error Formulas for Polynomial Collocation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="derivatives-and-the-method-of-undetermined-coefficents.html">
   15. Approximating Derivatives by the Method of Undetermined Coefficients
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="richardson-extrapolation.html">
   16. Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-1-building-blocks.html">
   17. Definite Integrals, Part 1: The Building Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-2-composite-rules.html">
   18. Definite Integrals, Part 2: The Composite Trapezoid and Midpoint Rules
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-3-simpson-richardson.html">
   19. Definite Integrals, Part 3: The (Composite) Simpson’s Rule and Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../future_topics.html">
   20. Some Future Topics
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Exercises
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/root-finding-by-interval-halving-exercises.html">
   Exercises on the Bisection Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/fixed-point-iteration-exercises.html">
   Exercises on Fixed Point Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/error-measures-convergence-rates-exercises.html">
   Exercises on Error Measures and Convergence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/newtons-method-exercises.html">
   Exercises on Newton’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/root-finding-without-derivatives-exercises.html">
   Exercises on Root-finding Without Derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/machine-numbers-rounding-error-and-error-propagation-exercises.html">
   Exercises on Machine Numbers, Rounding Error and Error Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exercises/simultaneous-linear-equations-exercises.html">
   Exercises on Solving Simultaneous Linear Equations
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/MATH375-assignment1.html">
   MATH 375 Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/MATH375-assignment2.html">
   MATH 375 Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/MATH375-assignment3.html">
   MATH 375 Assignment 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root_finding.html">
   Module root_finding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/MATH375-assignment4.html">
   MATH 375 Assignment 4
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Preliminary Versions of Future Sections
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../preliminary_versions/introduction.html">
   1. Introduction to
   <em>
    Preliminary Versions
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../preliminary_versions/definite-integrals-4-romberg-integration.html">
   2. Definite Integrals, Part 4: Romberg Integration — Preliminary Version
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../preliminary_versions/ODE-IVP-1-basics-and-Euler.html">
   3. Solving Initial Value Problems for Ordinary Differential Equations, Part 1: Basic Concepts and Euler’s Method — Preliminary Version
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../preliminary_versions/ODE-IVP-2-Runge-Kutta.html">
   4. Solving Initial Value Problems for ODEs, Part 2: Runge-Kutta Methods — Preliminary Version
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../preliminary_versions/simultaneous-linear-equations-5-error-bounds-condition-numbers.html">
   5. Error bounds for linear algebra: condition numbers, matrix norms, etc. — Preliminary Version
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Python and Jupyter Notebook Review (with Numpy and Matplotlib)
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/introduction.html">
   1. Introduction to
   <em>
    Python Preview
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/getting-python-software-for-scientific-computing.html">
   2. Getting Python Software for Scientific Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/suggestions-on-python-and-notebook-usage.html">
   3. Suggestions and Notes on Python and Jupyter Notebook Usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/python-variables-lists-tuples-numpy-arrays.html">
   4. Python Variables, Including Lists and Tuples, and Arrays from Package Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/functions.html">
   5. Defining and Using Python Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/decisions-with-if-else-elif.html">
   6. Decision Making With if, else, and elif
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/iteration-with-for.html">
   7. Iteration with
   <code class="docutils literal notranslate">
    <span class="pre">
     for
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/iteration-with-while.html">
   8. Iteration with
   <code class="docutils literal notranslate">
    <span class="pre">
     while
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/code-files-modules-IDEs.html">
   9. Code Files, Modules, and an Integrated Development Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/graphing-with-matplotlib.html">
   10. Plotting Graphs with Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/array-operations-and-linear-algebra.html">
   11. Numpy Array Operations and Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/scipy-tools-for-linear-algebra.html">
   12. Package Scipy and More Tools for Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/summation-and-integration.html">
   13. Summation and Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/random-numbers-and-simulation.html">
   14. Random Numbers, Histograms, and a Simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/formatted-output-and-some-text-string-manipulation.html">
   15. Formatted Output and Some Text String Manipulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/classes-objects-attributes-methods.html">
   16. Classes, Objects, Attributes, Methods: Very Basic Object-Oriented Programming in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_review/exception-handling.html">
   17. Exceptions and Exception Handling
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="numerical_methods_module.html">
   Notebook for generating the module
   <code class="docutils literal notranslate">
    <span class="pre">
     numerical_methods_module
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendices/linear-algebra-with-0-based-indexing-and-semiopen-intervals.html">
   Linear algebra algorithms using 0-based indexing and semi-open intervals
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Numerical Analysis Sample Project on Newtons’s Method
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/python_notebooks_modules/sample-project-newtons-method-draft.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/python_notebooks_modules/sample-project-newtons-method-draft.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#newton-s-method-for-solving-f-x-0">
   Newton’s method for solving
   <span class="math notranslate nohighlight">
    \(f(x) = 0\)
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algorithm">
     Algorithm
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1-x-cos-x">
     Example 1:
     <span class="math notranslate nohighlight">
      \(x = \cos(x)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2-find-the-smallest-positive-root-of-x-tan-x-more-difficult">
     Example 2: Find the smallest positive root of
     <span class="math notranslate nohighlight">
      \(x = \tan(x)\)
     </span>
     (more difficult!)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-quasi-newton-method">
   The Quasi-Newton Method
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Algorithm
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-3-repeat-the-above-basic-test-case-x-cos-x-with-the-quasi-newton-method-much-slower">
     Example 3: Repeat the above basic test case
     <span class="math notranslate nohighlight">
      \(x = \cos(x)\)
     </span>
     with the Quasi-Newton Method — much slower!
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#observations-and-conclusions">
   Observations and Conclusions
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="numerical-analysis-sample-project-on-newtons-s-method">
<h1>Numerical Analysis Sample Project on Newtons’s Method<a class="headerlink" href="#numerical-analysis-sample-project-on-newtons-s-method" title="Permalink to this headline">¶</a></h1>
<p><strong>Brenton LeMesurier</strong></p>
<p><strong>Draft of February 24, 2021</strong></p>
<p>The Python code for the algorithms is imported from the module <code class="docutils literal notranslate"><span class="pre">newton_project.py</span></code></p>
<div class="section" id="newton-s-method-for-solving-f-x-0">
<h2>Newton’s method for solving <span class="math notranslate nohighlight">\(f(x) = 0\)</span><a class="headerlink" href="#newton-s-method-for-solving-f-x-0" title="Permalink to this headline">¶</a></h2>
<p>Newton’s method is based on the iterative formula
$<span class="math notranslate nohighlight">\(x_{n+1} = x_n-f(x_n)/f'(x_n).\)</span>$</p>
<p>A good algorithm needs conditions to stop the iteration, deal with failures like non-convergence and division by zero, and for efficiency, should not evaluate any function twice for the same argument <span class="math notranslate nohighlight">\(x_n\)</span>.
The algorithm here stops when any of three conditions is met:</p>
<ul class="simple">
<li><p>The estimated error <span class="math notranslate nohighlight">\(|x_n - x_{n-1}|\)</span> is below a specified error tolerance,</p></li>
<li><p>The backward error <span class="math notranslate nohighlight">\(|f(x_n)|\)</span> is below a specified error tolerance, or</p></li>
<li><p>A specified maximum number of iterations have been performed.</p></li>
</ul>
<p>To help assess the cost of this method, output of the total number of function evaluations is added.</p>
<div class="section" id="algorithm">
<h3>Algorithm<a class="headerlink" href="#algorithm" title="Permalink to this headline">¶</a></h3>
<p><strong>Input:</strong></p>
<ul class="simple">
<li><p>Functions <span class="math notranslate nohighlight">\(f(x)\)</span> and its derivative <span class="math notranslate nohighlight">\(Df(x)\)</span></p></li>
<li><p>Initial approximation <span class="math notranslate nohighlight">\(x_0\)</span></p></li>
<li><p>Tolerances <span class="math notranslate nohighlight">\(x_{tol}\)</span> for the error in the <span class="math notranslate nohighlight">\(x\)</span> value and <span class="math notranslate nohighlight">\(f_{tol}\)</span> for the backward error (how close <span class="math notranslate nohighlight">\(f(x)\)</span> is to zero)</p></li>
<li><p>A limit on the number of iterations to attempt, <code class="docutils literal notranslate"><span class="pre">iterationsMax</span></code>.</p></li>
</ul>
<p><strong>Output:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span>, the final approximation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">errorEstimate</span></code>, the estimated absolute error in this approximation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">backwardError</span></code>, the backward error <span class="math notranslate nohighlight">\(|f(x)|\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">functionEvaluations</span></code>, the number of evaluations of the functions <span class="math notranslate nohighlight">\(f(x)\)</span> and <span class="math notranslate nohighlight">\(Df(x)\)</span>.</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(x \leftarrow x_0\)</span><br>
<span class="math notranslate nohighlight">\(\text{fx} \leftarrow f(x)\)</span><br>
<span class="math notranslate nohighlight">\(\text{functionEvaluations} \leftarrow 1\)</span><br>
for iteration from 1 to iterationsMax:<br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(\text{Dfx} \leftarrow Df(x)\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(\text{functionEvaluations} \leftarrow \text{functionEvaluations} + 1\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> if <span class="math notranslate nohighlight">\(\text{Dfx} = 0\)</span> <em>Comment: cannot continue; division by zero.</em><br>
<span class="math notranslate nohighlight">\(\quad\quad\)</span> End (i.e. leave this algorithm), with a warning about failure to converge.<br>
<span class="math notranslate nohighlight">\(\quad\)</span> end if<br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(\delta x \leftarrow -fx/Dfx\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(x \leftarrow x + \delta x\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(\text{fx} \leftarrow f(x)\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(\text{functionEvaluations} \leftarrow \text{functionEvaluations} + 1\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(\text{errorEstimate} \leftarrow |\delta x|\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(\text{backwardError} \leftarrow |fx|\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> if <span class="math notranslate nohighlight">\(\text{errorEstimate} \leq x_{tol}\)</span> or <span class="math notranslate nohighlight">\(\text{backwardError} \leq f_{tol}\)</span><br>
<span class="math notranslate nohighlight">\(\quad\quad\)</span> End successfully, with output of x, errorestimate, backwarderror, functionEvaluations<br>
<span class="math notranslate nohighlight">\(\quad\)</span> end if<br>
end for<br>
<strong>Warning:</strong> if we reach here, the loop above finished without returning,
so the iterations did not converged to sufficient accuracy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The main algorithms</span>
<span class="kn">from</span> <span class="nn">newton_project</span> <span class="kn">import</span> <span class="n">newton</span>
<span class="kn">from</span> <span class="nn">newton_project</span> <span class="kn">import</span> <span class="n">quasiNewton</span>

<span class="c1"># For the test cases</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">tan</span><span class="p">,</span> <span class="n">exp</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-1-x-cos-x">
<h3>Example 1: <span class="math notranslate nohighlight">\(x = \cos(x)\)</span><a class="headerlink" href="#example-1-x-cos-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Df1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">errortol</span> <span class="o">=</span> <span class="mf">1e-8</span>
<span class="n">fvaltol</span> <span class="o">=</span> <span class="mf">1e-15</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Using initial approximation x_0 =&#39;</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span>
      <span class="s1">&#39;error tolerance&#39;</span><span class="p">,</span> <span class="n">errortol</span><span class="p">,</span>
      <span class="s1">&#39;backward error tolerance&#39;</span><span class="p">,</span> <span class="n">fvaltol</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">errorestimate</span><span class="p">,</span> <span class="n">backwarderror</span><span class="p">,</span> <span class="n">functionEvaluations</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">Df1</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">errortol</span><span class="p">,</span> <span class="n">fvaltol</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">if</span> <span class="n">errorestimate</span> <span class="o">&lt;=</span> <span class="n">errortol</span> <span class="ow">or</span> <span class="n">backwarderror</span> <span class="o">&lt;=</span> <span class="n">fvaltol</span><span class="p">:</span>  <span class="c1"># Success</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Success!&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error tolerance was not met.  The best we can say is that&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The solution is approximately&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;with estimated error&#39;</span><span class="p">,</span> <span class="n">errorestimate</span><span class="p">,</span> <span class="s1">&#39;and backward error&#39;</span><span class="p">,</span> <span class="n">backwarderror</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The calculation required&#39;</span><span class="p">,</span> <span class="n">functionEvaluations</span><span class="p">,</span> <span class="s1">&#39;function evaluations.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using initial approximation x_0 = 0.0 error tolerance 1e-08 backward error tolerance 1e-15
step number n, x_n, error estimate, backward error:
1 1.0 1.0 0.45969769413186023
2 0.7503638678402439 0.24963613215975608 0.018923073822117442
3 0.7391128909113617 0.011250976928882236 4.645589899088254e-05
4 0.7390851333852839 2.7757526077753238e-05 2.847204694234051e-10
5 0.7390851332151606 1.7012334067709158e-10 1.1102230246251565e-16
Success!
The solution is approximately 0.7390851332151606
with estimated error 1.7012334067709158e-10 and backward error 1.1102230246251565e-16
The calculation required 11 function evaluations.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span> <span class="o">=</span> <span class="mf">100.0</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Using initial approximation x_0 =&#39;</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span>
      <span class="s1">&#39;error tolerance&#39;</span><span class="p">,</span> <span class="n">errortol</span><span class="p">,</span>
      <span class="s1">&#39;backward error tolerance&#39;</span><span class="p">,</span> <span class="n">fvaltol</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">errorestimate</span><span class="p">,</span> <span class="n">backwarderror</span><span class="p">,</span> <span class="n">functionEvaluations</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">Df1</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">errortol</span><span class="p">,</span> <span class="n">fvaltol</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">if</span> <span class="n">errorestimate</span> <span class="o">&lt;=</span> <span class="n">errortol</span> <span class="ow">or</span> <span class="n">backwarderror</span> <span class="o">&lt;=</span> <span class="n">fvaltol</span><span class="p">:</span>  <span class="c1"># Success</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Success!&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error tolerance was not met.  The best we can say is that&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The solution is approximately&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;with estimated error&#39;</span><span class="p">,</span> <span class="n">errorestimate</span><span class="p">,</span> <span class="s1">&#39;and backward error&#39;</span><span class="p">,</span> <span class="n">backwarderror</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The calculation required&#39;</span><span class="p">,</span> <span class="n">functionEvaluations</span><span class="p">,</span> <span class="s1">&#39;function evaluations&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using initial approximation x_0 = 100.0 error tolerance 1e-08 backward error tolerance 1e-15
step number n, x_n, error estimate, backward error:
1 -100.83221384870296 200.83221384870296 101.78718050765721
2 43.898456593084916 144.73067044178788 42.90196915432232
3 -2.9245849938401633 46.82304158692508 1.9480388973376201
4 -0.44203136417168265 2.4825536296684807 1.3459159231167994
5 1.9100493194227757 2.3520806835944583 2.2428320738976044
6 0.7557374249453708 1.154311894477405 0.0279714286913334
7 0.7391452994681547 0.01659212547721615 0.00010069630247322436
8 0.7390851340144209 6.016545373382826e-05 1.337651545085805e-09
9 0.7390851332151607 7.992602355197513e-10 0.0
Success!
The solution is approximately 0.7390851332151607
with estimated error 7.992602355197513e-10 and backward error 0.0
The calculation required 19 function evaluations
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-2-find-the-smallest-positive-root-of-x-tan-x-more-difficult">
<h3>Example 2: Find the smallest positive root of <span class="math notranslate nohighlight">\(x = \tan(x)\)</span> (more difficult!)<a class="headerlink" href="#example-2-find-the-smallest-positive-root-of-x-tan-x-more-difficult" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span>
<span class="k">def</span> <span class="nf">Df2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errortol</span><span class="o">=</span><span class="mf">1e-8</span>
<span class="n">fvaltol</span><span class="o">=</span><span class="mf">1e-15</span>
<span class="c1">#x_0 = 4.28  # fails</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="mf">4.29</span>  <span class="c1"># succeeds</span>
<span class="c1">#x_0 = 4.71  # succeeds</span>
<span class="c1">#x_0 = 4.72  # converges to the wrong root</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Using initial approximation x_0 =&#39;</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span>
      <span class="s1">&#39;error tolerance&#39;</span><span class="p">,</span> <span class="n">errortol</span><span class="p">,</span>
      <span class="s1">&#39;backward error tolerance&#39;</span><span class="p">,</span> <span class="n">fvaltol</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">errorest</span><span class="p">,</span> <span class="n">absfx</span><span class="p">,</span> <span class="n">functionEvaluations</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="n">Df2</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">errortol</span><span class="p">,</span> <span class="n">fvaltol</span><span class="p">)</span>

<span class="k">if</span> <span class="n">errorestimate</span> <span class="o">&lt;=</span> <span class="n">errortol</span> <span class="ow">or</span> <span class="n">backwarderror</span> <span class="o">&lt;=</span> <span class="n">fvaltol</span><span class="p">:</span>  <span class="c1"># Success</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Success!&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error tolerance was not met.  The best we can say is that&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The solution is approximately&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;with estimated error&#39;</span><span class="p">,</span> <span class="n">errorest</span><span class="p">,</span> <span class="s1">&#39;and backward error&#39;</span><span class="p">,</span> <span class="n">backwarderror</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The calculation required&#39;</span><span class="p">,</span> <span class="n">functionEvaluations</span><span class="p">,</span> <span class="s1">&#39;function evaluations.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using initial approximation x_0 = 4.29 error tolerance 1e-08 backward error tolerance 1e-15
Success!
The solution is approximately 4.493409457909064
with estimated error 7.070815230647819e-12 and backward error 0.0
The calculation required 25 function evaluations.
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="the-quasi-newton-method">
<h2>The Quasi-Newton Method<a class="headerlink" href="#the-quasi-newton-method" title="Permalink to this headline">¶</a></h2>
<p>This speeds iteration by using the original derivative <span class="math notranslate nohighlight">\(Df(x_0)\)</span> at each iteration, instead of updating each time.
If this take less than about twice as many iterations as the true Newton method, it can be faster.
However, its main benefit is for system of equations, as considered below.</p>
<div class="section" id="id1">
<h3>Algorithm<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p><strong>Input:</strong></p>
<ul class="simple">
<li><p>Functions <span class="math notranslate nohighlight">\(f(x)\)</span> and its derivative <span class="math notranslate nohighlight">\(Df(x)\)</span></p></li>
<li><p>Initial approximation <span class="math notranslate nohighlight">\(x_0\)</span></p></li>
<li><p>Tolerances <span class="math notranslate nohighlight">\(x_{tol}\)</span> for the error in the <span class="math notranslate nohighlight">\(x\)</span> value and <span class="math notranslate nohighlight">\(f_{tol}\)</span> for the backward error (how close <span class="math notranslate nohighlight">\(f(x)\)</span> is to zero)</p></li>
<li><p>A limit on the number of iterations to attempt, <code class="docutils literal notranslate"><span class="pre">stepsmax</span></code>.</p></li>
</ul>
<p><strong>Output:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span>, the final approximation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">errorestimate</span></code>, the estimated absolute error in this approximation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">backwarderror</span></code>, the backward error <span class="math notranslate nohighlight">\(|f(x)|\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">functionEvaluations</span></code>, the number of evaluations of the functions <span class="math notranslate nohighlight">\(f(x)\)</span> and <span class="math notranslate nohighlight">\(Df(x)\)</span>.</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(x \leftarrow x_0\)</span><br>
<span class="math notranslate nohighlight">\(\text{fx} \leftarrow f(x)\)</span><br>
Dfx_0 <span class="math notranslate nohighlight">\(\leftarrow Df(x_0)\)</span><br>
<span class="math notranslate nohighlight">\(\text{functionEvaluations} \leftarrow 2\)</span><br>
for step = 1 to stepsmax<br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(\delta x \leftarrow -fx/Dfx_0\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(x \leftarrow x + \delta x\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(fx \leftarrow f(x)\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(\text{functionEvaluations} \leftarrow \text{functionEvaluations} + 1\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(\text{errorestimate} \leftarrow |\delta x|\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(\text{backwarderror} \leftarrow |fx|\)</span><br>
<span class="math notranslate nohighlight">\(\quad\)</span> if <span class="math notranslate nohighlight">\(\text{errorestimate} \leq x_{tol}\)</span> or <span class="math notranslate nohighlight">\(\text{backwarderror} \leq f_{tol}\)</span><br>
<span class="math notranslate nohighlight">\(\quad\quad\)</span> End successfully, with output of x, errorestimate, backwarderror, functionEvaluations<br>
<span class="math notranslate nohighlight">\(\quad\)</span> end if<br>
end for<br>
<strong>Warning:</strong> if we reach here, the loop above finished without returning,
so the iterations did not converged to sufficient accuracy.</p>
</div>
<div class="section" id="example-3-repeat-the-above-basic-test-case-x-cos-x-with-the-quasi-newton-method-much-slower">
<h3>Example 3: Repeat the above basic test case <span class="math notranslate nohighlight">\(x = \cos(x)\)</span> with the Quasi-Newton Method — much slower!<a class="headerlink" href="#example-3-repeat-the-above-basic-test-case-x-cos-x-with-the-quasi-newton-method-much-slower" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">errortol</span><span class="o">=</span><span class="mf">1e-8</span>
<span class="n">fvaltol</span><span class="o">=</span><span class="mf">1e-15</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Using initial approximation x_0 =&#39;</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span>
      <span class="s1">&#39;error tolerance&#39;</span><span class="p">,</span> <span class="n">errortol</span><span class="p">,</span>
      <span class="s1">&#39;backward error tolerance&#39;</span><span class="p">,</span> <span class="n">fvaltol</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">errorest</span><span class="p">,</span> <span class="n">absfx</span><span class="p">,</span> <span class="n">functionEvaluations</span> <span class="o">=</span> <span class="n">quasiNewton</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">Df1</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">errortol</span><span class="p">,</span> <span class="n">fvaltol</span><span class="p">)</span>

<span class="k">if</span> <span class="n">errorestimate</span> <span class="o">&lt;=</span> <span class="n">errortol</span> <span class="ow">or</span> <span class="n">backwarderror</span> <span class="o">&lt;=</span> <span class="n">fvaltol</span><span class="p">:</span>  <span class="c1"># Success</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Success!&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error tolerance was not met.  The best we can say is that&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The solution is approximately&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;with estimated error&#39;</span><span class="p">,</span> <span class="n">errorest</span><span class="p">,</span> <span class="s1">&#39;and backward error&#39;</span><span class="p">,</span> <span class="n">backwarderror</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The calculation required&#39;</span><span class="p">,</span> <span class="n">functionEvaluations</span><span class="p">,</span> <span class="s1">&#39;function evaluations.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using initial approximation x_0 = 0.0 error tolerance 1e-08 backward error tolerance 1e-15
Success!
The solution is approximately 0.7390851366465718
with estimated error 8.525458006225506e-09 and backward error 0.0
The calculation required 49 function evaluations.
</pre></div>
</div>
</div>
</div>
<p><strong>To Do:</strong> test on the harder case, <span class="math notranslate nohighlight">\(x = \tan(x)\)</span></p>
</div>
</div>
<div class="section" id="observations-and-conclusions">
<h2>Observations and Conclusions<a class="headerlink" href="#observations-and-conclusions" title="Permalink to this headline">¶</a></h2>
<p>These are incomplete (this is only a draft!)</p>
<p>The first things to note are:</p>
<ul class="simple">
<li><p>the sensitivity to initial conditions,</p></li>
<li><p>the slowness of the quasi-Newton method, and</p></li>
<li><p>the problems that can arise when there are multiple solutions.</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./python_notebooks_modules"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../appendices/linear-algebra-with-0-based-indexing-and-semiopen-intervals.html" title="previous page">Linear algebra algorithms using 0-based indexing and semi-open intervals</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Brenton LeMesurier, College of Charleston and University of Northern Colorado<br/>
        
            &copy; Copyright 2020–2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>