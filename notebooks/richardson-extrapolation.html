
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>16. Richardson Extrapolation &#8212; Elementary Numerical Analysis (with Python)</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="17. Definite Integrals, Part 1: The Building Blocks" href="definite-integrals-1-building-blocks-python.html" />
    <link rel="prev" title="15. Approximating Derivatives by the Method of Undetermined Coefficients" href="derivatives-and-the-method-of-undetermined-coefficents.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/UNC_BearMascot.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Elementary Numerical Analysis (with Python)</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../preface.html">
   Elementary Numerical Analysis with Python
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Frontmatter
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../plans-for-expansion-improvement.html">
   Full Disclosure: Things I Plan to do to Expand and Improve This Book
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Numerical Analysis
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-by-interval-halving-python.html">
   1. Root Finding by Interval Halving (Bisection)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fixed-point-iteration-python.html">
   2. Solving Equations by Fixed Point Iteration (of Contraction Mappings)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newtons-method-python.html">
   3. Newton’s Method for Solving Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="taylors-theorem.html">
   4. Taylor’s Theorem and the Accuracy of Linearization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error-measures-convergence-rates.html">
   5. Measures of Error and Order of Convergence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newtons-method-convergence-rate.html">
   6. The Convergence Rate of Newton’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-without-derivatives-python.html">
   7. Root-finding Without Derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-1-row-reduction-python.html">
   8. Simultaneous Linear Equations, Part 1: Row Reduction/Gaussian Elimination
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="machine-numbers-rounding-error-and-error-propagation-python.html">
   9. Machine Numbers, Rounding Error and Error Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-2-pivoting-python.html">
   10. Simultaneous Linear Equations, Part 2: Partial Pivoting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-3-lu-factorization-python.html">
   11. Simultaneous Linear Equations, Part 3: Solving
   <span class="math notranslate nohighlight">
    \(Ax = b\)
   </span>
   with LU factorization,
   <span class="math notranslate nohighlight">
    \(A = L U\)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-4-plu-factorization-python.html">
   12. Simultaneous Linear Equations, Part 4: Solving
   <span class="math notranslate nohighlight">
    \(Ax = b\)
   </span>
   With Both Pivoting and LU factorization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polynomial-collocation%2Bapproximation-python.html">
   13. Polynomial Collocation (Interpolation/Extrapolation) and Approximation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polynomial-collocation-error-formulas-python.html">
   14. Error Formulas for Polynomial Collocation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="derivatives-and-the-method-of-undetermined-coefficents.html">
   15. Approximating Derivatives by the Method of Undetermined Coefficients
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   16. Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-1-building-blocks-python.html">
   17. Definite Integrals, Part 1: The Building Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-2-composite-rules.html">
   18. Definite Integrals, Part 2: The Composite Trapezoid and Midpoint Rules
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-3-simpson-richardson.html">
   19. Definite Integrals, Part 3: The (Composite) Simpson’s Rule and Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-4-romberg-integration.html">
   20. Definite Integrals, Part 4: Romberg Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-1-basics-and-Euler-python.html">
   21. Initial Value Problems for Ordinary Differential Equations, Part 1: Basic Concepts and Euler’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-2-Runge-Kutta-python.html">
   22. Initial Value Problems for ODEs, Part 2: Runge-Kutta Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-3-error-results-one-step-methods.html">
   23. Initial Value Problems for Ordinary Differential Equations, Part 3: Global Error Bounds for One Step Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-4-system-higher-order-equations.html">
   24. Initial Value Problems for Ordinary Differential Equations, Part 4: Systems of ODEs and Higher Order ODEs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-5-error-control.html">
   25. Initial Value Problems for Ordinary Differential Equations, Part 5: Error Control and Variable Step Sizes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../future_topics.html">
   26. Some Future Topics
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Preliminary Versions of Future Sections
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-5-error-bounds-condition-numbers-python.html">
   1. Simultaneous Linear Equations, Part 5: Error bounds for linear algebra, condition numbers, matrix norms, etc.
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Exercises
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-by-interval-halving-exercises-python.html">
   Exercises on the Bisection Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fixed-point-iteration-exercises.html">
   Exercises on Fixed Point Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error-measures-convergence-rates-exercises.html">
   Exercises on Error Measures and Convergence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newtons-method-exercises.html">
   Exercises on Newton’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-without-derivatives-exercises.html">
   Exercises on Root-finding Without Derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="machine-numbers-rounding-error-and-error-propagation-exercises.html">
   Exercises on Machine Numbers, Rounding Error and Error Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-exercises.html">
   Exercises on Solving Simultaneous Linear Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="derivatives-and-the-method-of-undetermined-coefficents-exercises.html">
   Exercises on Approximating Derivatives, the Method of Undetermined Coefficients and Richardson Extrapolation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="assignment1.html">
   MATH 375 Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment2.html">
   MATH 375 Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment3.html">
   MATH 375 Assignment 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root_finding.html">
   Module root_finding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment4.html">
   MATH 375 Assignment 4
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Some Final Project Possibilities
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="project-possibilities.html">
   Some Final Project Possibilites
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project-possibilities.html#minimizing-functions-of-one-and-several-variables">
   Minimizing Functions of One and Several Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project-possibilities.html#root-finding-by-repeated-inverse-quadratic-approximation-with-bracketing">
   Root-finding by Repeated Inverse Quadratic Approximation with Bracketing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project-possibilities.html#a-more-reliable-secant-method">
   A More Reliable Secant Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project-possibilities.html#computing-eigenvalues-and-eigenvectors">
   Computing Eigenvalues and Eigenvectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project-possibilities.html#iterative-methods-for-solving-simultaneous-linear-equations-ax-b">
   Iterative Methods for Solving Simultaneous Linear Equations,
   <span class="math notranslate nohighlight">
    \(Ax = b\)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project-possibilities.html#solving-simultaneous-nonlinear-equations">
   Solving Simultaneous Nonlinear Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project-possibilities.html#fitting-smooth-piecewise-cubic-functions-to-data">
   Fitting Smooth Piecewise Cubic Functions to Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project-possibilities.html#least-squares-fitting-to-data-and-functions">
   Least-Squares Fitting to Data and Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project-possibilities.html#boundary-value-problems-for-differential-equations">
   Boundary Value Problems for Differential Equations
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Project on Numerical Calculus
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/tasks-1-and-2-centered-difference-derivative-approximation-and-richardson.html">
   Centered Difference Approximation of the Derivative
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/tasks-1-and-2-centered-difference-derivative-approximation-and-richardson.html#improving-on-the-centered-difference-approximation-with-richardson-extrapolation">
   Improving on the Centered Difference Approximation with Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-3-composite-trapezoid-rule.html">
   The Composite Trapezoid Rule (and Composite Midpoint Rule)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-4-recursive-trapezoid-rule.html">
   The Recursive Trapezoid Rule, with error control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-5-modified-trapezoid-method.html">
   The Modified Trapezoid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-6-modified-trapezoid-without-derivatives.html">
   The Modified Trapezoid Method, without derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-7-romberg-method.html">
   The Romberg Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/test-cases-differentiation.html">
   Test Cases for Differentiation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/test-cases-integration.html">
   Test Cases for Integration
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Python and Jupyter Notebook Review (with Numpy and Matplotlib)
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/introduction.html">
   1. Introduction to
   <em>
    Python Preview
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/getting-python-software-for-scientific-computing.html">
   2. Getting Python Software for Scientific Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/suggestions-on-python-and-notebook-usage.html">
   3. Suggestions and Notes on Python and Jupyter Notebook Usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/python-variables-lists-tuples-numpy-arrays.html">
   4. Python Variables, Including Lists and Tuples, and Arrays from Package Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/functions.html">
   5. Defining and Using Python Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/decisions-with-if-else-elif.html">
   6. Decision Making With if, else, and elif
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/iteration-with-for.html">
   7. Iteration with
   <code class="docutils literal notranslate">
    <span class="pre">
     for
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/iteration-with-while.html">
   8. Iteration with
   <code class="docutils literal notranslate">
    <span class="pre">
     while
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/code-files-modules-IDEs.html">
   9. Code Files, Modules, and an Integrated Development Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/recursion.html">
   10. Recursion (vs iteration)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/graphing-with-matplotlib.html">
   11. Plotting Graphs with Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/array-operations-and-linear-algebra.html">
   12. Numpy Array Operations and Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/scipy-tools-for-linear-algebra.html">
   13. Package Scipy and More Tools for Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/summation-and-integration.html">
   14. Summation and Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/random-numbers-and-simulation.html">
   15. Random Numbers, Histograms, and a Simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/formatted-output-and-some-text-string-manipulation.html">
   16. Formatted Output and Some Text String Manipulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/classes-objects-attributes-methods.html">
   17. Classes, Objects, Attributes, Methods: Very Basic Object-Oriented Programming in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/exception-handling.html">
   18. Exceptions and Exception Handling
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="numerical_methods_module.html">
   Notebook for generating the module
   <code class="docutils literal notranslate">
    <span class="pre">
     numerical_methods_module
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear-algebra-with-0-based-indexing-and-semiopen-intervals.html">
   Linear algebra algorithms using 0-based indexing and semi-open intervals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sample-project-newtons-method-python-draft.html">
   Numerical Analysis Sample Project on Newtons’s Method
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/richardson-extrapolation.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/notebooks/richardson-extrapolation.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   16.1. Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#procedure">
   16.2. Procedure
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#addendum-rewriting-to-get-an-error-estimate">
     16.2.1. Addendum: rewriting to get an error estimate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     16.2.2. Example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1-a">
     16.2.3. Exercise 1(a)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1-b">
     16.2.4. Exercise 1(b)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2">
     16.2.5. Exercise 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-variant-more-useful-for-integration-and-ode-boundary-value-problems-parameter-n">
   16.3. A variant, more useful for integration and ODE boundary value problems: parameter
   <span class="math notranslate nohighlight">
    \(n\)
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-common-verbal-description-for-both-forms">
     16.3.1. A common verbal description for both forms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#addendum-rewriting-to-get-an-error-estimate-again">
     16.3.2. Addendum: Rewriting to get an error estimate, again
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#repeated-richardson-extrapolation">
   16.4. Repeated Richardson extrapolation
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="richardson-extrapolation">
<h1><span class="section-number">16. </span>Richardson Extrapolation<a class="headerlink" href="#richardson-extrapolation" title="Permalink to this headline">¶</a></h1>
<p><strong>Revised March 24, 2021:</strong>
adding notes on practical error estimates for both the <a class="reference external" href="#h-error-estimates"><span class="math notranslate nohighlight">\(h\)</span></a> and <a class="reference external" href="#n-error-estimates"><span class="math notranslate nohighlight">\(n\)</span></a> versions.</p>
<p>Also in previous revisions,
the notation has been changed from <span class="math notranslate nohighlight">\(Q\)</span> and <span class="math notranslate nohighlight">\(\phi(h)\)</span> to <span class="math notranslate nohighlight">\(Q_0\)</span> and <span class="math notranslate nohighlight">\(Q(h)\)</span>.</p>
<p>This work is licensed under <a class="reference external" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a></p>
<hr class="docutils" />
<p><strong>References:</strong></p>
<ul class="simple">
<li><p>Section 5.1.3 <em>Extrapolation</em> of <a class="reference external" href="../references.html#Sauer">Sauer</a></p></li>
<li><p>Section 4.2 <em>Richardson Extrapolation</em> of <a class="reference external" href="../references.html#Burden-Faires">Burden&amp;Faires</a></p></li>
<li><p>Section 4.2 <em>Estimating Derivatives and Richardson Extrapolation</em> of <a class="reference external" href="../references.html#Chenney-Kincaid">Chenney&amp;Kincaid</a></p></li>
</ul>
<div class="section" id="motivation">
<h2><span class="section-number">16.1. </span>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>With derivative approximations like</p>
<div class="math notranslate nohighlight">
\[\Delta_h f(x) := \frac{f(x+h) - f(x)}{h} = Df(x) + \frac{D^2f(x)}{2} h + O(h^2) = Df(x) + O(h)\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\delta_h^2 f(x) := \frac{f(x-h) - 2f(x) + f(x+h)}{h^2} = D^2f(x) + \frac{D^4f(x)}{12}h^2 + O(h^4) = D^2f(x) + O(h^2)\]</div>
<p>there are limits on the ability to improve accuracy by simply using a smaller value of <span class="math notranslate nohighlight">\(h\)</span>:
one is that rounding error become problematic.</p>
<p>Another is that when we are approximating the derivative at a collection of points in an interval <span class="math notranslate nohighlight">\([a,b]\)</span>, <span class="math notranslate nohighlight">\(x_i = a + ih\)</span>, <span class="math notranslate nohighlight">\(0 \leq i \leq n\)</span>, <span class="math notranslate nohighlight">\(h = \displaystyle\frac{b-a}{n}\)</span>, reducing <span class="math notranslate nohighlight">\(h\)</span> requires increasing the number of points <span class="math notranslate nohighlight">\(n+1\)</span>, and so increases the “cost” (time and other resources needed) of the calculation.</p>
<p>Thus we would like to produce new approximation formulas of higher order <span class="math notranslate nohighlight">\(p\)</span>; that is, with error <span class="math notranslate nohighlight">\(O(h^p)\)</span> for <span class="math notranslate nohighlight">\(p\)</span> greater than the values <span class="math notranslate nohighlight">\(p=1\)</span> for <span class="math notranslate nohighlight">\(\Delta_h f(x)\)</span> or <span class="math notranslate nohighlight">\(p=2\)</span> for <span class="math notranslate nohighlight">\(\delta_h^2 f(x)\)</span>.</p>
</div>
<div class="section" id="procedure">
<h2><span class="section-number">16.2. </span>Procedure<a class="headerlink" href="#procedure" title="Permalink to this headline">¶</a></h2>
<p>The general framework for this is an exact quantity <span class="math notranslate nohighlight">\(Q_0\)</span> for which we have an approximation formula <span class="math notranslate nohighlight">\(Q(h)\)</span> with</p>
<div class="math notranslate nohighlight">
\[Q(h) = Q_0 + c_p h^p + O(h^q), = Q_0 + O(h^p), \quad q &gt; p\]</div>
<p>and we wish to achieve adequate accuracy while keeping <span class="math notranslate nohighlight">\(h\)</span> as large as possible.</p>
<p>The kernel of the idea is to initially ignore the smaller part of the error, <span class="math notranslate nohighlight">\(O(h^q)\)</span> and just consider</p>
<div class="math notranslate nohighlight">
\[Q(h) \approx Q_0 + c_p h^p,\]</div>
<p>and evaluate for two values of <span class="math notranslate nohighlight">\(h\)</span>; most often either <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(2h\)</span> (or <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(h/2\)</span>, which ismore or less equivalent.)</p>
<p>That gives</p>
<div class="math notranslate nohighlight">
\[Q(2h) \approx Q_0 + c_p (2h)^p = Q_0 + c_p 2^p h^p,\]</div>
<p>and with only <span class="math notranslate nohighlight">\(Q_0\)</span> and <span class="math notranslate nohighlight">\(c_p\)</span> unknown, this is two (approximate) linear equations in two unknowns, so we can solve for the desired quantity <span class="math notranslate nohighlight">\(Q_0\)</span> by basic Gaussian elimination.
This gives</p>
<div class="math notranslate nohighlight">
\[
Q_0 \approx \frac{2^p Q(h) - Q(2h)}{2^p - 1} =: Q_q(h).
\]</div>
<p>But is this new approximation any better than the original?
Using the more complete error formula above for <span class="math notranslate nohighlight">\(Q(h)\)</span> and its version with <span class="math notranslate nohighlight">\(h\)</span> replaced by <span class="math notranslate nohighlight">\(2h\)</span>,</p>
<div class="math notranslate nohighlight">
\[
Q(2h) = Q_0 + c_p(2h)^p + O((2h)^q), = Q_0 + 2^p c_p h^p + O(h^q),
\]</div>
<p>one gets</p>
<div class="math notranslate nohighlight">
\[
Q_q(h) = \frac{2^p \phi(h) - \phi(2h)}{2^p - 1} = Q_0 + O(h^q),
\]</div>
<p>so indeed an improvement, since <span class="math notranslate nohighlight">\(q&gt;p\)</span>.</p>
<p><a name="h-error-estimates"></a></p>
<div class="section" id="addendum-rewriting-to-get-an-error-estimate">
<h3><span class="section-number">16.2.1. </span>Addendum: rewriting to get an error estimate<a class="headerlink" href="#addendum-rewriting-to-get-an-error-estimate" title="Permalink to this headline">¶</a></h3>
<p>We can get a useful practical error estimate by rewriting the above result as</p>
<div class="math notranslate nohighlight">
\[
Q_0 \approx Q(h) + \frac{Q(h) - Q(2h)}{2^p - 1}
\]</div>
<p>so that the quantity</p>
<div class="math notranslate nohighlight">
\[
E_h := \frac{Q(h) - Q(2h)}{2^p - 1} \approx Q_0 - Q(h)
\]</div>
<p>is approximately the error in <span class="math notranslate nohighlight">\(Q(h)\)</span>.
Thus,</p>
<ol class="simple">
<li><p>Richardson extrapolation can be viewed as “correcting” <span class="math notranslate nohighlight">\(Q_h\)</span> by subtracting of this estimated error:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
Q_0 \approx Q_q(h) = Q_h + E_h
\]</div>
<ol class="simple">
<li><p>This magnitude <span class="math notranslate nohighlight">\(|E_h|\)</span> of this error estimate can be used as a (typically pessimistic!) estimate of the error in the correted result <span class="math notranslate nohighlight">\(Q_q\)</span>.
Sometimes makes sens to use an even more cautious error estimate, by discarding the denominator <span class="math notranslate nohighlight">\(2^p-1\)</span>:
using <span class="math notranslate nohighlight">\(|Q(h) - Q(2h)|\)</span> as an estimate of the error in the extrapolated value <span class="math notranslate nohighlight">\(Q_q\)</span>.</p></li>
</ol>
<p>Either way, these follow the pervasive pattern of using the change between the two most recent approximations as an error estimate.</p>
<p>Note the analogy to Newton’s method for solving <span class="math notranslate nohighlight">\(f(x)=0\)</span>, which can be broken into the two steps</p>
<ul class="simple">
<li><p>estimate the error in approximate root <span class="math notranslate nohighlight">\(x_n\)</span> as <span class="math notranslate nohighlight">\(E_n := -f(x_n)/f'(x_n)\)</span></p></li>
<li><p>update the approximation to <span class="math notranslate nohighlight">\(x_{n+1} = x_n + E_n\)</span>.</p></li>
</ul>
<p>Finally, note that this is always <em>extrapolation</em>, in the sense of “going beyond”: the new approximation is on the opposite side of the better of the original approximations from the less accurate of them.</p>
</div>
<div class="section" id="example">
<h3><span class="section-number">16.2.2. </span>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>For the basic forward difference approximation above, this process give a three-point method of second order accuracy (<span class="math notranslate nohighlight">\(q=2\)</span>):</p>
<div class="math notranslate nohighlight">
\[
\frac{2 \Delta_h f(x) - \Delta_{2h}f(x)}{2 - 1} = 2 \frac{f(x+h) - f(x)}{h} - \frac{f(x+2h) - f(x)}{2h}
= \frac{-3f(x) + 4f(x+h) - f(x+2h)}{2h} = Df(x) + O(h^2).
\]</div>
</div>
<div class="section" id="exercise-1-a">
<h3><span class="section-number">16.2.3. </span>Exercise 1(a)<a class="headerlink" href="#exercise-1-a" title="Permalink to this headline">¶</a></h3>
<p>Apply Richardson extrapolation to the standard three-point, second order accurate approximation
<span class="math notranslate nohighlight">\(Q(h) := \delta_h^2 f(x)\)</span> of the second derivative <span class="math notranslate nohighlight">\(Q_0 := D^2f(x)\)</span> as given above, and verify that it gives a fourth-order accurate five-point approximation formula.</p>
</div>
<div class="section" id="exercise-1-b">
<h3><span class="section-number">16.2.4. </span>Exercise 1(b)<a class="headerlink" href="#exercise-1-b" title="Permalink to this headline">¶</a></h3>
<p>As a supplementary exercise, one could verify the order of accuracy directly with Taylor polynomials, or verify that the new formula has degree of precision <span class="math notranslate nohighlight">\(d=5\)</span>, and hence is of order <span class="math notranslate nohighlight">\(p=4\)</span> due to the formula <span class="math notranslate nohighlight">\(d = p+k-1\)</span> for approximations of <span class="math notranslate nohighlight">\(k\)</span>-th derivatives, given in the notes for Day 11.</p>
<p>One could also derive the same formula “from scratch” using the Method of Undetermined Coefficients.</p>
</div>
<div class="section" id="exercise-2">
<h3><span class="section-number">16.2.5. </span>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this headline">¶</a></h3>
<p>Apply Richardson extrapolation to the above one-sided three-point, second order accurate approximation of the derivative <span class="math notranslate nohighlight">\(Df(x)\)</span>, and verify that it gives a third-order accurate four-point approximation formula.</p>
<p>But note something strange about this new formula: it skips <span class="math notranslate nohighlight">\(f(x+3h)\)</span>.</p>
<p>Here, instead of extrapolating, one is probably better off applying the Method of Undetermined Coefficients directly with data <span class="math notranslate nohighlight">\(f(x)\)</span>, <span class="math notranslate nohighlight">\(f(x+h)\)</span>, <span class="math notranslate nohighlight">\(f(x+2h)\)</span>, <span class="math notranslate nohighlight">\(f(x+3h)\)</span> and <span class="math notranslate nohighlight">\(f(x+4h)\)</span>: what order of accuracy does that give?</p>
</div>
</div>
<div class="section" id="a-variant-more-useful-for-integration-and-ode-boundary-value-problems-parameter-n">
<h2><span class="section-number">16.3. </span>A variant, more useful for integration and ODE boundary value problems: parameter <span class="math notranslate nohighlight">\(n\)</span><a class="headerlink" href="#a-variant-more-useful-for-integration-and-ode-boundary-value-problems-parameter-n" title="Permalink to this headline">¶</a></h2>
<p>A slight variant of the above is approximation with an integer parameter <span class="math notranslate nohighlight">\(n\)</span>, such as approximations of integrals by the (composite) trapezoid rule with <span class="math notranslate nohighlight">\(n\)</span> intervals, <span class="math notranslate nohighlight">\(T_n\)</span>, or the approximate solution of an ordinary differential equation at the above-described collection of <span class="math notranslate nohighlight">\(n+1\)</span> equally spaced values in domain <span class="math notranslate nohighlight">\([a,b]\)</span>.
Then a more natural ntito of teh approxatio formula is <span class="math notranslate nohighlight">\(Q_n\)</span> instead of <span class="math notranslate nohighlight">\(Q(h)\)</span>.</p>
<p>The errors of the form <span class="math notranslate nohighlight">\(c_p h^p + O(h^q)\)</span> become</p>
<div class="math notranslate nohighlight">
\[Q_n = Q_0 + O\left(\frac{1}{n^p}\right) = Q_0 + \frac{c_p}{n^p} + O\left(\frac{1}{n^q}\right).\]</div>
<p>The main difference is that to work with integer values of <span class="math notranslate nohighlight">\(n\)</span>, it must be the quantity that is doubled, whereas doubling of <span class="math notranslate nohighlight">\(h\)</span> would correspond to halving of <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>The extrapolation formula becomes</p>
<div class="math notranslate nohighlight">
\[
Q_0 = \frac{2^p Q_{2n} - Q_n}{2^p - 1} + O\left(\frac{1}{n^q}\right).
\]</div>
<p><strong>Aside:</strong> For the slightly more general case of increasing from <span class="math notranslate nohighlight">\(n\)</span> to <span class="math notranslate nohighlight">\(k n\)</span>, one gets</p>
<div class="math notranslate nohighlight">
\[
Q_0 = \frac{k^p Q_{k n} - Q_n}{k^p - 1} + O\left(\frac{1}{n^q}\right).
\]</div>
<div class="section" id="a-common-verbal-description-for-both-forms">
<h3><span class="section-number">16.3.1. </span>A common verbal description for both forms<a class="headerlink" href="#a-common-verbal-description-for-both-forms" title="Permalink to this headline">¶</a></h3>
<p>This can be summarized with the same verbal form as the original formula:</p>
<ul class="simple">
<li><p>“<span class="math notranslate nohighlight">\(2^p\)</span> times the more accurate approximation,</p></li>
<li><p>minus the less accurate approximation,</p></li>
<li><p>all divided by <span class="math notranslate nohighlight">\((2^p - 1)\)</span>”</p></li>
</ul>
<p>Also</p>
<p>“The error in the more accurate approximation is approximated by the difference between the two approximations, divided by <span class="math notranslate nohighlight">\((2^p - 1)\)</span>”</p>
<p><a name="n-error-estimates"></a></p>
</div>
<div class="section" id="addendum-rewriting-to-get-an-error-estimate-again">
<h3><span class="section-number">16.3.2. </span>Addendum: Rewriting to get an error estimate, again<a class="headerlink" href="#addendum-rewriting-to-get-an-error-estimate-again" title="Permalink to this headline">¶</a></h3>
<p>As with the “<span class="math notranslate nohighlight">\(h\)</span>” form above, this extrapolation can be broken into two steps</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
E_{2n} &amp;:= \frac{Q_{2n} - Q_n}{2^p - 1},
\\
Q_0 &amp;= Q_{2n} + E_{2n} + O\left(\frac{1}{n^q}\right).
\end{split}
\end{split}\]</div>
<p>so <span class="math notranslate nohighlight">\(E_{2n}\)</span> estimates the error in <span class="math notranslate nohighlight">\(Q_{2n}\)</span>, and the improved approxmation can be expressed as</p>
<div class="math notranslate nohighlight">
\[
Q_{2n} + E_{2n}.
\]</div>
</div>
</div>
<div class="section" id="repeated-richardson-extrapolation">
<h2><span class="section-number">16.4. </span>Repeated Richardson extrapolation<a class="headerlink" href="#repeated-richardson-extrapolation" title="Permalink to this headline">¶</a></h2>
<p>The new improved approximation formulas have the same sort of error formula, but for order <span class="math notranslate nohighlight">\(q\)</span> instead of order <span class="math notranslate nohighlight">\(p\)</span>, so we could extrapolate again to get an even higher order method, and this can be done numerous times if there is a suitable power series in <span class="math notranslate nohighlight">\(h\)</span> or <span class="math notranslate nohighlight">\(1/n\)</span> for the errors.</p>
<p>That is not so useful for derivative approximations, where one can get the same or better results with the method of underermined coefficients, but can be very useful for integration methods, and for the related task of solving boundary value problems for ordinary differential equations.</p>
<p>For example, it can be applied to the composite trapezoid rule, giving the composite Simpson’s rule at the first step, and then a succession of approximations of ever higher order – this is known as the <strong>Romberg method.</strong></p>
<p>Repeated Richardson extrapolation can also be applied to the approximate solution of dofferential equations;
we might explore that later.</p>
<hr class="docutils" />
<p>This work is licensed under <a class="reference external" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="derivatives-and-the-method-of-undetermined-coefficents.html" title="previous page"><span class="section-number">15. </span>Approximating Derivatives by the Method of Undetermined Coefficients</a>
    <a class='right-next' id="next-link" href="definite-integrals-1-building-blocks-python.html" title="next page"><span class="section-number">17. </span>Definite Integrals, Part 1: The Building Blocks</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Brenton LeMesurier, College of Charleston and University of Northern Colorado<br/>
        
            &copy; Copyright 2020–2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>