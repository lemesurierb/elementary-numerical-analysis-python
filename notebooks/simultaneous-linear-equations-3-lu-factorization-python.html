
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>11. Simultaneous Linear Equations, Part 3: Solving \(Ax = b\) with LU factorization, \(A = L U\) &#8212; Elementary Numerical Analysis (with Python)</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="12. Simultaneous Linear Equations, Part 4: Solving \(Ax = b\) With Both Pivoting and LU factorization" href="simultaneous-linear-equations-4-plu-factorization-python.html" />
    <link rel="prev" title="10. Simultaneous Linear Equations, Part 2: Partial Pivoting" href="simultaneous-linear-equations-2-pivoting-python.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/UNC_BearMascot.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Elementary Numerical Analysis (with Python)</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../preface.html">
   Elementary Numerical Analysis with Python
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Frontmatter
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../plans-for-expansion-improvement.html">
   Full Disclosure: Things I Plan to do to Expand and Improve This Book
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Numerical Analysis
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-by-interval-halving-python.html">
   1. Root Finding by Interval Halving (Bisection)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fixed-point-iteration-python.html">
   2. Solving Equations by Fixed Point Iteration (of Contraction Mappings)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newtons-method-python.html">
   3. Newton’s Method for Solving Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="taylors-theorem.html">
   4. Taylor’s Theorem and the Accuracy of Linearization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error-measures-convergence-rates.html">
   5. Measures of Error and Order of Convergence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newtons-method-convergence-rate.html">
   6. The Convergence Rate of Newton’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-without-derivatives-python.html">
   7. Root-finding Without Derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-1-row-reduction-python.html">
   8. Simultaneous Linear Equations, Part 1: Row Reduction/Gaussian Elimination
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="machine-numbers-rounding-error-and-error-propagation-python.html">
   9. Machine Numbers, Rounding Error and Error Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-2-pivoting-python.html">
   10. Simultaneous Linear Equations, Part 2: Partial Pivoting
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   11. Simultaneous Linear Equations, Part 3: Solving
   <span class="math notranslate nohighlight">
    \(Ax = b\)
   </span>
   with LU factorization,
   <span class="math notranslate nohighlight">
    \(A = L U\)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-4-plu-factorization-python.html">
   12. Simultaneous Linear Equations, Part 4: Solving
   <span class="math notranslate nohighlight">
    \(Ax = b\)
   </span>
   With Both Pivoting and LU factorization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polynomial-collocation%2Bapproximation-python.html">
   13. Polynomial Collocation (Interpolation/Extrapolation) and Approximation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polynomial-collocation-error-formulas-python.html">
   14. Error Formulas for Polynomial Collocation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="derivatives-and-the-method-of-undetermined-coefficents.html">
   15. Approximating Derivatives by the Method of Undetermined Coefficients
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="richardson-extrapolation.html">
   16. Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-1-building-blocks-python.html">
   17. Definite Integrals, Part 1: The Building Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-2-composite-rules.html">
   18. Definite Integrals, Part 2: The Composite Trapezoid and Midpoint Rules
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-3-simpson-richardson.html">
   19. Definite Integrals, Part 3: The (Composite) Simpson’s Rule and Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-4-romberg-integration.html">
   20. Definite Integrals, Part 4: Romberg Integration — Preliminary Version
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-1-basics-and-Euler-python.html">
   21. Initial Value Problems for Ordinary Differential Equations, Part 1: Basic Concepts and Euler’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-2-Runge-Kutta-python.html">
   22. Initial Value Problems for ODEs, Part 2: Runge-Kutta Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-3-error-results-one-step-methods.html">
   23. Initial Value Problems for Ordinary Differential Equations, Part 3: Global Error Bounds for One Step Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-4-system-higher-order-equations.html">
   24. Initial Value Problems for Ordinary Differential Equations, Part 4: Systems of ODEs and Higher Order ODEs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../future_topics.html">
   25. Some Future Topics
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Preliminary Versions of Future Sections
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-5-error-control.html">
   1. Initial Value Problems for Ordinary Differential Equations, Part 5: Error Control and Variable Step Sizes — Preview Edition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-5-error-bounds-condition-numbers-python.html">
   2. Simultaneous Linear Equations, Part 5: Error bounds for linear algebra, condition numbers, matrix norms, etc. — Preliminary Version
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Exercises
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-by-interval-halving-exercises-python.html">
   Exercises on the Bisection Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fixed-point-iteration-exercises.html">
   Exercises on Fixed Point Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error-measures-convergence-rates-exercises.html">
   Exercises on Error Measures and Convergence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newtons-method-exercises.html">
   Exercises on Newton’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-without-derivatives-exercises.html">
   Exercises on Root-finding Without Derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="machine-numbers-rounding-error-and-error-propagation-exercises.html">
   Exercises on Machine Numbers, Rounding Error and Error Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-exercises.html">
   Exercises on Solving Simultaneous Linear Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="derivatives-and-the-method-of-undetermined-coefficents-exercises.html">
   Exercises on Approximating Derivatives, the Method of Undetermined Coefficients and Richardson Extrapolation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="assignment1.html">
   MATH 375 Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment2.html">
   MATH 375 Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment3.html">
   MATH 375 Assignment 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root_finding.html">
   Module root_finding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment4.html">
   MATH 375 Assignment 4
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Project on Numerical Calculus
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-1-centered-difference-derivative-approximation.html">
   Centered Difference Approximation of the Derivative
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-2-centered-differences-richardson.html">
   Improving on the Centered Difference Approximation with Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-3-composite-trapezoid-rule.html">
   The Composite Trapezoid Rule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-4-recursive-trapezoid-rule.html">
   The Recursive Trapezoid Rule, with error control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-5-modified-trapezoid-method.html">
   The Modified Trapezoid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-6-modified-trapezoid-without-derivatives.html">
   The Modified Trapezoid Method, without derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-7-romberg-method.html">
   The Romberg Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/test-cases-differentiation.html">
   Test Cases for Differentiation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/test-cases-integration.html">
   Test Cases for Integration
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Python and Jupyter Notebook Review (with Numpy and Matplotlib)
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/introduction.html">
   1. Introduction to
   <em>
    Python Preview
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/getting-python-software-for-scientific-computing.html">
   2. Getting Python Software for Scientific Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/suggestions-on-python-and-notebook-usage.html">
   3. Suggestions and Notes on Python and Jupyter Notebook Usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/python-variables-lists-tuples-numpy-arrays.html">
   4. Python Variables, Including Lists and Tuples, and Arrays from Package Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/functions.html">
   5. Defining and Using Python Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/decisions-with-if-else-elif.html">
   6. Decision Making With if, else, and elif
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/iteration-with-for.html">
   7. Iteration with
   <code class="docutils literal notranslate">
    <span class="pre">
     for
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/iteration-with-while.html">
   8. Iteration with
   <code class="docutils literal notranslate">
    <span class="pre">
     while
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/code-files-modules-IDEs.html">
   9. Code Files, Modules, and an Integrated Development Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/recursion.html">
   10. Recursion (vs iteration)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/graphing-with-matplotlib.html">
   11. Plotting Graphs with Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/array-operations-and-linear-algebra.html">
   12. Numpy Array Operations and Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/scipy-tools-for-linear-algebra.html">
   13. Package Scipy and More Tools for Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/summation-and-integration.html">
   14. Summation and Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/random-numbers-and-simulation.html">
   15. Random Numbers, Histograms, and a Simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/formatted-output-and-some-text-string-manipulation.html">
   16. Formatted Output and Some Text String Manipulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/classes-objects-attributes-methods.html">
   17. Classes, Objects, Attributes, Methods: Very Basic Object-Oriented Programming in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/exception-handling.html">
   18. Exceptions and Exception Handling
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="numerical_methods_module.html">
   Notebook for generating the module
   <code class="docutils literal notranslate">
    <span class="pre">
     numerical_methods_module
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear-algebra-with-0-based-indexing-and-semiopen-intervals.html">
   Linear algebra algorithms using 0-based indexing and semi-open intervals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sample-project-newtons-method-python-draft.html">
   Numerical Analysis Sample Project on Newtons’s Method
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/simultaneous-linear-equations-3-lu-factorization-python.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/notebooks/simultaneous-linear-equations-3-lu-factorization-python.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#avoiding-repeated-calculation-excessive-rounding-and-messy-notation-lu-factorization">
   11.1. Avoiding repeated calculation, excessive rounding and messy notation: LU factorization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-direct-method-for-the-doolittle-lu-factorization">
   11.2. The direct method for the Doolittle LU factorization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-test-case-on-lu-factorization">
     11.2.1. A test case on LU factorization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forward-substitution-solving-lc-b-for-c">
     11.2.2. Forward substitution: solving
     <span class="math notranslate nohighlight">
      \(Lc = b\)
     </span>
     for
     <span class="math notranslate nohighlight">
      \(c\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-test-case-on-forward-substitution">
     11.2.3. A test case on forward substitution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#completing-the-test-case-with-backward-substitution">
     11.2.4. Completing the test case, with backward substitution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1">
     11.2.5. Exercise 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2">
     11.2.6. Exercise 2
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#creating-modules">
       11.2.6.1. Creating modules
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#when-is-it-safe-to-ignore-pivoting-quite-often-fortunately">
   11.3. When is it safe to ignore pivoting? Quite often, fortunately.
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="simultaneous-linear-equations-part-3-solving-ax-b-with-lu-factorization-a-l-u">
<h1><span class="section-number">11. </span>Simultaneous Linear Equations, Part 3: Solving <span class="math notranslate nohighlight">\(Ax = b\)</span> with LU factorization, <span class="math notranslate nohighlight">\(A = L U\)</span><a class="headerlink" href="#simultaneous-linear-equations-part-3-solving-ax-b-with-lu-factorization-a-l-u" title="Permalink to this headline">¶</a></h1>
<p><strong>References:</strong></p>
<ul class="simple">
<li><p>Section 2.2 <em>The LU Factorization</em> of <a class="reference external" href="../references.html#Sauer">Sauer</a></p></li>
<li><p>Section 6.5 <em>Matrix Factorizations</em> of <a class="reference external" href="../references.html#Burden-Faires">Burden&amp;Faires</a></p></li>
<li><p>Section 8.1 <em>Matrix Factorizations</em> of <a class="reference external" href="../references.html#Chenney-Kincaid">Chenney&amp;Kincaid</a></p></li>
</ul>
<div class="section" id="avoiding-repeated-calculation-excessive-rounding-and-messy-notation-lu-factorization">
<h2><span class="section-number">11.1. </span>Avoiding repeated calculation, excessive rounding and messy notation: LU factorization<a class="headerlink" href="#avoiding-repeated-calculation-excessive-rounding-and-messy-notation-lu-factorization" title="Permalink to this headline">¶</a></h2>
<p>Putting aside pivoting for a while, there is another direction in which the algorithm for solving linear systems <span class="math notranslate nohighlight">\(Ax=b\)</span> can be improved.
It starts with the idea of being more efficient when solving multiple system with the same right-hand side:
<span class="math notranslate nohighlight">\(A x^{(m)} = b^{(m)}, m=1,2, \dots\)</span>.</p>
<p>However it has several other benefits:</p>
<ul class="simple">
<li><p>allowing a strategy to reduce rounding error, and</p></li>
<li><p>a simpler, more elegant mathematical statement.</p></li>
</ul>
<p>We will see how to merge this with partial pivoting in
<a class="reference internal" href="simultaneous-linear-equations-4-plu-factorization-python.html"><span class="doc std std-doc">Simultaneous Linear Equations, Part 4.ipynb</span></a></p>
<p>Some useful jargon:</p>
<p><strong>Definition: triangular matrices</strong>
A matrix is <em>triangular</em> if all its non-zero elements are either on the main diagonal or to one side of it.
There are two possibilities:</p>
<ul class="simple">
<li><p>Matrix <span class="math notranslate nohighlight">\(U\)</span> is <em>upper triangular</em> if <span class="math notranslate nohighlight">\(u_{ij} = 0\)</span> for all <span class="math notranslate nohighlight">\(i &gt; j\)</span>.</p></li>
<li><p>Matrix <span class="math notranslate nohighlight">\(L\)</span> is <em>lower triangular</em> if <span class="math notranslate nohighlight">\(l_{ij} = 0\)</span> for all <span class="math notranslate nohighlight">\(j &gt; i\)</span>.</p></li>
</ul>
<p>One important example of an upper triangular matrix is <span class="math notranslate nohighlight">\(U\)</span> formed by row reduction;
note well that it is much quicker and easier to solve <span class="math notranslate nohighlight">\(Ux = c\)</span> than the original system <span class="math notranslate nohighlight">\(Ax=b\)</span> exactly because of its triangular form.</p>
<p>We will soon see that the multipliers <span class="math notranslate nohighlight">\(l_{ij}\)</span>, <span class="math notranslate nohighlight">\(i &gt; j\)</span> for row reduction that were introduced in section
<a class="reference internal" href="simultaneous-linear-equations-1-row-reduction-python.html"><span class="doc std std-doc">Solving Simultaneous Linear Equations, Part 1</span></a>
help to form a lower triangular matrix <span class="math notranslate nohighlight">\(L\)</span>.</p>
<p>The key to the LU factorization idea is finding a <strong>lower triangular</strong> matrix <span class="math notranslate nohighlight">\(L\)</span> and an <strong>upper triangular</strong> matrix <span class="math notranslate nohighlight">\(U\)</span> such that <span class="math notranslate nohighlight">\(L U = A\)</span>, and then using the fact that it is far quicker to solve a linear system when the corresponding matrix is triangular.</p>
<p>Indeed we will see that, if naive Gaussian elimination for <span class="math notranslate nohighlight">\(Ax=b\)</span> succeeds, giving row-reduced form <span class="math notranslate nohighlight">\(Ux = c\)</span>:</p>
<ol class="simple">
<li><p>The matrix <span class="math notranslate nohighlight">\(A\)</span> can be factorized as <span class="math notranslate nohighlight">\(A = LU\)</span> with <span class="math notranslate nohighlight">\(U\)</span> an <span class="math notranslate nohighlight">\(n \times n\)</span> upper triangular matrix and <span class="math notranslate nohighlight">\(L\)</span> an <span class="math notranslate nohighlight">\(n \times n\)</span> lower triangular matrix.</p></li>
<li><p>There is a unique such factorization with the further condition that <span class="math notranslate nohighlight">\(L\)</span> is <strong>unit lower triangular</strong>, which means the extra requirement that the value on its main daigonal are unity: <span class="math notranslate nohighlight">\(l_{k,k} = 1\)</span>.
This is called the <strong>Doolittle Factorization</strong> of <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
<li><p>In the Doolittle factorization, the matrix <span class="math notranslate nohighlight">\(U\)</span> is the one given by naive Gaussian elimination, and the elements of <span class="math notranslate nohighlight">\(L\)</span> below its main diagonal are the multipliers arising in naive Gaussian elimination. (The other elements of <span class="math notranslate nohighlight">\(L\)</span>, on and above the main diagonal, are the ones and zeros dictated by it being unit lower triangular: the same as for those elements in the <span class="math notranslate nohighlight">\(n \times n\)</span> identity matrix.)</p></li>
<li><p>The transformed right-hand side <span class="math notranslate nohighlight">\(c\)</span> arising from naive Gaussian elimination is the solution of the system <span class="math notranslate nohighlight">\(Lc = b\)</span>, and this is solvable by an procedure caled <strong>forward substitution</strong>, very similar to the backward subsitution used to solve <span class="math notranslate nohighlight">\(Ux = c\)</span>.</p></li>
</ol>
<p>Putting all this together: if naive Gaussian elimination works for <span class="math notranslate nohighlight">\(A\)</span>, we can introduce the name <span class="math notranslate nohighlight">\(c\)</span> for <span class="math notranslate nohighlight">\(Ux\)</span>, and note that <span class="math notranslate nohighlight">\(Ax = (LU)x = L(Ux) = Lc = b\)</span>. Then solving of the system
<span class="math notranslate nohighlight">\(Ax = b\)</span> can be done in three steps:</p>
<ol class="simple">
<li><p>Using <span class="math notranslate nohighlight">\(A\)</span>, find the Doolittle factors, <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span>.</p></li>
<li><p>Using <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, solve <span class="math notranslate nohighlight">\(Lc = b\)</span> to get <span class="math notranslate nohighlight">\(c\)</span>. (Forward substitution)</p></li>
<li><p>Using <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(c\)</span>, solve <span class="math notranslate nohighlight">\(Ux = c\)</span> to get <span class="math notranslate nohighlight">\(x\)</span>.  (Backward substitution)</p></li>
</ol>
</div>
<div class="section" id="the-direct-method-for-the-doolittle-lu-factorization">
<h2><span class="section-number">11.2. </span>The direct method for the Doolittle LU factorization<a class="headerlink" href="#the-direct-method-for-the-doolittle-lu-factorization" title="Permalink to this headline">¶</a></h2>
<p>If you believe the above claims, we already have one algorithm for finding an LU factorization; basically, do naive Gaussian elimination, but ignore the right-hand side <span class="math notranslate nohighlight">\(b\)</span> until later.
However, there is another “direct” method, which does not rely on anything we have seen before about Gaussian elimination, and has other advantages as we will see.</p>
<p>(If I were teaching linear algebra, I would be tempted to start here and skip Gaussian Elimination!)</p>
<p>This method starts by considering the apparently daunting task of solving the <span class="math notranslate nohighlight">\(n^2\)</span> simultaneous and nonlinear equations for the initially unknown elements of <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \sum_{k=1}^n l_{i,k} u_{k,j} = a_{i,j}\; 1 \leq i \leq n,\;1 \leq j \leq n. \]</div>
<p>The first step is to insert the known information; the already-known values of elements of <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span>.
For one thing, the sums above stop when either <span class="math notranslate nohighlight">\(k=i\)</span> or <span class="math notranslate nohighlight">\(k=j\)</span>, whichever comes first,
due to all the zeros in <span class="math notranslate nohighlight">\(L\)</span> nd <span class="math notranslate nohighlight">\(U\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \sum_{k=1}^{\min(i,j)} l_{i,k} u_{k,j} = a_{i,j}\; 1 \leq i \leq n,\;1 \leq j \leq n. \]</div>
<p>Next, when <span class="math notranslate nohighlight">\(i \leq j\)</span>—  so that the sum ends at <span class="math notranslate nohighlight">\(k=i\)</span> and involves <span class="math notranslate nohighlight">\(l_{i,i}\)</span> — we can use <span class="math notranslate nohighlight">\(l_{i,i} = 1\)</span>.</p>
<p>So break up into two cases:</p>
<p>On and above the main diagonal (<span class="math notranslate nohighlight">\(i \leq j\)</span>, so <span class="math notranslate nohighlight">\(\min(i,j) = i\)</span>):</p>
<div class="math notranslate nohighlight">
\[\sum_{k=1}^{i-1}l_{i,k} u_{k,j}+u_{i,j}=a_{i,j} \quad 1\leq i \leq n,\; i \leq j \leq n.\]</div>
<p>Below the main diagonal (<span class="math notranslate nohighlight">\(i &gt; j\)</span>, so <span class="math notranslate nohighlight">\(\min(i,j) = j\)</span>):</p>
<div class="math notranslate nohighlight">
\[\sum_{k=1}^{j-1} l_{i,k} u_{k,j} + l_{i,j} u_{j,j}= a_{i,j} \quad 2 \leq i \leq n,\;1 \leq j \leq i.\]</div>
<p>In each equation, the last term in the sum has been separated, so that we can use them to “solve” for an unknown:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
u_{i,j} &amp;= a_{i,j} - \sum_{k=1}^{i-1} l_{i,k} u_{k,j} \quad 1 \leq i \leq n,\;i \leq j \leq n.
\\
l_{i,j} &amp;= \frac{a_{i,j} - \sum_{k=1}^{j-1} l_{i,k} u_{k,j}}{u_{j,j}} \quad 2 \leq i \leq n,\;1 \leq j \leq i.
\end{split}
\end{split}\]</div>
<p>Here comes the characteristic step that gets us from valid equations to a useful algorithm: we can arrange these equations in an order such that all the values at right are determined by an earlier equation!</p>
<p>First look at what they say for the first row and first column.</p>
<p>With <span class="math notranslate nohighlight">\(i=1\)</span> in the first equation, there is no sum, and so:
$<span class="math notranslate nohighlight">\(
u_{1,j}=a_{1,j}, \quad 1 \leq j \leq n,
\)</span>$
which is the familiar fact that the first row is unchanged in naive Gaussian elimination.</p>
<p>Next, with <span class="math notranslate nohighlight">\(j=1\)</span> in the second equation, there is again no sum:
$<span class="math notranslate nohighlight">\(
l_{i,1} = \frac{a_{i,1}}{u_{1,1}}, = \frac{u_{i,1}}{u_{1,1}}, \quad 2 \leq i \leq n,
\)</span>$
which is indeed the multipliers in the first step of naive Gaussian elimination.</p>
<p>Remember that one way to think of Gaussian elimination is <em>recursively</em>: after step <span class="math notranslate nohighlight">\(k\)</span>, one just applies the same process recursively to the smaller <span class="math notranslate nohighlight">\(n-k \times n-k\)</span> matrix in the bottom-right-hand corner. We can do something similar here; at stage <span class="math notranslate nohighlight">\(k\)</span>:</p>
<ol class="simple">
<li><p>First use the first of the above equations to solve first for row <span class="math notranslate nohighlight">\(k\)</span> of <span class="math notranslate nohighlight">\(U\)</span>, meaning just <span class="math notranslate nohighlight">\(u_{k,j}, j \geq k\)</span>,</p></li>
<li><p>Then use the second equation to solve for column <span class="math notranslate nohighlight">\(k\)</span> of <span class="math notranslate nohighlight">\(L\)</span>: <span class="math notranslate nohighlight">\(l_{i,k}, i &gt; k\)</span>.</p></li>
</ol>
<p>Stage <span class="math notranslate nohighlight">\(k=1\)</span> is handled by the simpler special equations above, so for the rest:</p>
<p>for k from 2 to n
<br><span class="math notranslate nohighlight">\(\quad\)</span> for j from k to n <span class="math notranslate nohighlight">\(\qquad\)</span> <em>Get the non-zero elements in row <span class="math notranslate nohighlight">\(k\)</span> of <span class="math notranslate nohighlight">\(U\)</span></em>
<br><span class="math notranslate nohighlight">\(\quad\quad\)</span> <span class="math notranslate nohighlight">\(u_{k,j}=a_{k,j} - \sum_{s=1}^{k-1}l_{k,s}u_{s,j}\)</span>
<br><span class="math notranslate nohighlight">\(\quad\)</span> end for
<br><span class="math notranslate nohighlight">\(\quad\)</span> for i from k+1 to n <span class="math notranslate nohighlight">\(\qquad\)</span> <em>Get the non-zero elements in column <span class="math notranslate nohighlight">\(k\)</span> of <span class="math notranslate nohighlight">\(L\)</span> (except the 1’s on its diagonal)</em>
<br><span class="math notranslate nohighlight">\(\quad\quad\)</span> <span class="math notranslate nohighlight">\(l_{i,k}=\displaystyle\frac{a_{i,k}-\sum_{s=1}^{k-1}l_{i,s}u_{s,k}}{u_{k,k}}\)</span>
<br><span class="math notranslate nohighlight">\(\quad\)</span> end for
<br>end for</p>
<p>Note well that in the formulas to evaluate at the right,</p>
<ol class="simple">
<li><p>The terms <span class="math notranslate nohighlight">\(l_{k,s}\)</span> are for <span class="math notranslate nohighlight">\(s &lt; k\)</span>, so from a column <span class="math notranslate nohighlight">\(s\)</span> that has already been computed for a previous <span class="math notranslate nohighlight">\(k\)</span> value.</p></li>
<li><p>The terms <span class="math notranslate nohighlight">\(u_{s,j}\)</span> are for <span class="math notranslate nohighlight">\(s &lt; k\)</span>, so from a row <span class="math notranslate nohighlight">\(s\)</span> that has already been computed for a previous <span class="math notranslate nohighlight">\(k\)</span> value.</p></li>
<li><p>The denominator <span class="math notranslate nohighlight">\(u_{k,k}\)</span> in the second inner loop is computed just in time, in the first inner loop for the same <span class="math notranslate nohighlight">\(k\)</span> value.</p></li>
</ol>
<p>So the only thing that can go wrong is the same as before: a zero pivot element <span class="math notranslate nohighlight">\(u_{k,k}\)</span>.</p>
<p><strong>Notes</strong></p>
<ol class="simple">
<li><p>For <span class="math notranslate nohighlight">\(k=n\)</span>, the second inner loop is redundant, so could be eliminated.
Indeed it might need to be eliminated in actual code, where “empty loops” might not be allowed.
On the other hand, allowing empty loops makes the above correct also for <span class="math notranslate nohighlight">\(k=1\)</span>; then the <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">k</span></code> loop encompases the entire factorization algorithm.</p></li>
<li><p>This direct factorization algorithm avoids any intermediate modification of arrays, and thus eliminates all those superscripts like <span class="math notranslate nohighlight">\(a_{i,j}^{(k)}\)</span>.
This is not only nicer mathematically, but can help to avoid mistakes like code that inadvertently modifies the array containing the matrix <span class="math notranslate nohighlight">\(A\)</span> and then uses it to compute the residual, <span class="math notranslate nohighlight">\(Ax - b\)</span>.
More generally, such purely mathematical statements of algorithms can help to avoid coding errors;
this is part of the philosophy of the <em>functional programming</em> approach.</p></li>
<li><p>Careful examination shows that the product <span class="math notranslate nohighlight">\(l_{k,s} u_{s,j}\)</span> that is part of what is substracted at location <span class="math notranslate nohighlight">\((k,j)\)</span> is the same as what is subtracted there at stage <span class="math notranslate nohighlight">\(k\)</span> of Gaussian elimination, just with different names.
More generally, <em>every piece of arithmetic is the same as before,</em> except arranged in a different order, so that the <span class="math notranslate nohighlight">\(k-1\)</span> changes made to an element in row <span class="math notranslate nohighlight">\(k\)</span> are done together, via those sums.</p></li>
<li><p>Rewrites with zero-based indexing will be provided later.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import some items from modules individually, so they can be used by &quot;first name only&quot;.</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">zeros_like</span><span class="p">,</span> <span class="n">identity</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lu</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">demoMode</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the Doolittle LU factorization of A.</span>
<span class="sd">    Sums like $\sum_{s=1}^{k-1} l_{k,s} u_{s,j}$ are done as matrix products;</span>
<span class="sd">    in the above case, row matrix L[k, 1:k-1] by column matrix U[1:k-1,j] gives the sum for a give j,</span>
<span class="sd">    and row matrix L[k, 1:k-1] by matrix U[1:k-1,k:n] gives the relevant row vector.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>  <span class="c1"># len() gives the number of rows in a 2D array.</span>
    <span class="c1"># Initialize U as the zero matrix;</span>
    <span class="c1"># correct below the main diagonal, with the other entries to be computed below.</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">zeros_like</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="c1"># Initialize L as the identity matrix;</span>
    <span class="c1"># correct on and above the main diagonal, with the other entries to be computed below.</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">identity</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="c1"># Column and row 1 (i.e Python index 0) are special:</span>
    <span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
    <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">demoMode</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;After step k=0&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;U=</span><span class="se">\n</span><span class="si">{</span><span class="n">U</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L=</span><span class="se">\n</span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">U</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">:]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">:]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="n">k</span><span class="p">,:</span><span class="n">k</span><span class="p">]</span> <span class="o">@</span> <span class="n">U</span><span class="p">[:</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">:]</span>
        <span class="n">L</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">:,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">:,</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">:,:</span><span class="n">k</span><span class="p">]</span> <span class="o">@</span> <span class="n">U</span><span class="p">[:</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="n">U</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">demoMode</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;After step </span><span class="si">{</span><span class="n">k</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;U=</span><span class="se">\n</span><span class="si">{</span><span class="n">U</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L=</span><span class="se">\n</span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># The last row (index &quot;-1&quot;) is special: nothing to do for L</span>
    <span class="n">U</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">U</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">demoMode</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;After the final step, k=</span><span class="si">{</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;U=</span><span class="se">\n</span><span class="si">{</span><span class="n">U</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-test-case-on-lu-factorization">
<h3><span class="section-number">11.2.1. </span>A test case on LU factorization<a class="headerlink" href="#a-test-case-on-lu-factorization" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A=</span><span class="se">\n</span><span class="si">{</span><span class="n">A</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A=
[[ 4.  2.  7.]
 [ 3.  5. -6.]
 [ 1. -3.  2.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">demoMode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>After step k=0
U=
[[4. 2. 7.]
 [0. 0. 0.]
 [0. 0. 0.]]
L=
[[1.   0.   0.  ]
 [0.75 1.   0.  ]
 [0.25 0.   1.  ]]
After step k=1
U=
[[  4.     2.     7.  ]
 [  0.     3.5  -11.25]
 [  0.     0.     0.  ]]
L=
[[ 1.    0.    0.  ]
 [ 0.75  1.    0.  ]
 [ 0.25 -1.    1.  ]]
After the final step, k=2
U=
[[  4.     2.     7.  ]
 [  0.     3.5  -11.25]
 [  0.     0.   -11.  ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A=</span><span class="se">\n</span><span class="si">{</span><span class="n">A</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L=</span><span class="se">\n</span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;U=</span><span class="se">\n</span><span class="si">{</span><span class="n">U</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L times U is </span><span class="se">\n</span><span class="si">{</span><span class="n">L</span><span class="nd">@U</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The &#39;residual&#39; A - LU is </span><span class="se">\n</span><span class="si">{</span><span class="n">A</span> <span class="o">-</span> <span class="n">L</span><span class="nd">@U</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A=
[[ 4.  2.  7.]
 [ 3.  5. -6.]
 [ 1. -3.  2.]]
L=
[[ 1.    0.    0.  ]
 [ 0.75  1.    0.  ]
 [ 0.25 -1.    1.  ]]
U=
[[  4.     2.     7.  ]
 [  0.     3.5  -11.25]
 [  0.     0.   -11.  ]]
L times U is 
[[ 4.  2.  7.]
 [ 3.  5. -6.]
 [ 1. -3.  2.]]
The &#39;residual&#39; A - LU is 
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="forward-substitution-solving-lc-b-for-c">
<h3><span class="section-number">11.2.2. </span>Forward substitution: solving <span class="math notranslate nohighlight">\(Lc = b\)</span> for <span class="math notranslate nohighlight">\(c\)</span><a class="headerlink" href="#forward-substitution-solving-lc-b-for-c" title="Permalink to this headline">¶</a></h3>
<p>This is the last piece missing. The strategy is very similar to backward substitution, but slightly simplified by the ones on the main didogonal of <span class="math notranslate nohighlight">\(L\)</span>.
The equations <span class="math notranslate nohighlight">\(L c = b\)</span> can be written much as above, separating off the last term in the sum:</p>
<div class="math notranslate nohighlight">
\[ \sum_{j=1}^{n} l_{i,j} c_j = b_i,\; 1 \leq i \leq n \]</div>
<div class="math notranslate nohighlight">
\[ \sum_{j=1}^{i} l_{i,j} c_j = b_i,\; 1 \leq i \leq n \]</div>
<div class="math notranslate nohighlight">
\[ \sum_{j=1}^{i-1} l_{i,j} c_j + c_i = b_i,\; 1 \leq i \leq n \]</div>
<p>Then solve for <span class="math notranslate nohighlight">\(c_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[ c_i = b_i - \sum_{j=1}^{i-1} l_{i,j} c_j \]</div>
<p>These are already is usable order: the right-hand side in the equation for <span class="math notranslate nohighlight">\(c_i\)</span> involves only the <span class="math notranslate nohighlight">\(c_j\)</span> values with <span class="math notranslate nohighlight">\(j &lt; i\)</span>, determined by earlier equations if we run through index <span class="math notranslate nohighlight">\(i\)</span> in increasing order.</p>
<p>First, <span class="math notranslate nohighlight">\(i=1\)</span></p>
<div class="math notranslate nohighlight">
\[ c_1 = b_1 - \sum_{j=1}^{0} l_{1,j} c_j, = b_1 \]</div>
<p>Next, <span class="math notranslate nohighlight">\(i=2\)</span></p>
<div class="math notranslate nohighlight">
\[ c_2 = b_2 - \sum_{j=1}^{1} l_{2,j} c_j, = b_2 - l_{2,1}c_1 \]</div>
<p>Next, <span class="math notranslate nohighlight">\(i=3\)</span></p>
<div class="math notranslate nohighlight">
\[ c_3 = b_3 - \sum_{j=1}^{2} l_{3,j} c_j, = b_3 - l_{3,1} c_1 - l_{3,2} c_2 \]</div>
<p>I leave as an exerise expressing this is pseudo-code (adjusted to zero-based indexing);
here it is in Python; also availab from th module <code class="docutils literal notranslate"><span class="pre">numerical_methods_module</span></code> with</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>from numerical_methods_module import forwardSubstitution
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">forwardSubstitution</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solve L c = b for c.&quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">zeros_like</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,:</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">c</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
        <span class="c1"># Note: the above uses a row-by-column matrix multiplication to do the same as</span>
        <span class="c1">#c[i] = b[i] - sum(L[i,:i] * c[:i])</span>
    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="a-test-case-on-forward-substitution">
<h3><span class="section-number">11.2.3. </span>A test case on forward substitution<a class="headerlink" href="#a-test-case-on-forward-substitution" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;b = </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b = [2. 3. 4.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">forwardSubstitution</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;c = </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The residual b - Lc is </span><span class="si">{</span><span class="n">b</span> <span class="o">-</span> <span class="n">L</span><span class="nd">@c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> with maximum norm </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">L</span><span class="nd">@c</span><span class="p">))</span><span class="si">:</span><span class="s2">0.3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c = [2.  1.5 5. ]
The residual b - Lc is [0. 0. 0.]
	 with maximum norm 0.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="completing-the-test-case-with-backward-substitution">
<h3><span class="section-number">11.2.4. </span>Completing the test case, with backward substitution<a class="headerlink" href="#completing-the-test-case-with-backward-substitution" title="Permalink to this headline">¶</a></h3>
<p>As this step is unchanged, just import the version seen in a previous section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numerical_methods_module</span> <span class="kn">import</span> <span class="n">backwardSubstitution</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">backwardSubstitution</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The residual c - Ux for the backward substitution step is </span><span class="si">{</span><span class="n">c</span> <span class="o">-</span> <span class="n">U</span><span class="nd">@x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> with maximum norm </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">U</span><span class="nd">@x</span><span class="p">))</span><span class="si">:</span><span class="s2">0.3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The residual b - Ax for the whole solving process is </span><span class="si">{</span><span class="n">b</span> <span class="o">-</span> <span class="n">A</span><span class="nd">@x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> with maximum norm </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">A</span><span class="nd">@x</span><span class="p">))</span><span class="si">:</span><span class="s2">0.3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The residual c - Ux for the backward substitution step is [0. 0. 0.]
	 with maximum norm 0.0
The residual b - Ax for the whole solving process is [ 0.0000000e+00 -4.4408921e-16  8.8817842e-16]
	 with maximum norm 8.88e-16
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-1">
<h3><span class="section-number">11.2.5. </span>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h3>
<p>A) Express this forward substitution strategy as pseudo-code, with zero-based indexing.</p>
<p>Then implement it “directly” in a Python function, with format:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>def forwardSubstitution(L, b):
    . . .
    return c
</pre></div>
</div>
<p>Do this “directly” with explcit evaluation of the sums <span class="math notranslate nohighlight">\(\sum_{j=1}^{i-1} l_{i,j} c_j\)</span>,
rather than using the matrix multiplication short-cut above.</p>
<p>B) Test it, using this often-useful “reverse-engineering” tactic:</p>
<ol class="simple">
<li><p>Create suitable test arrays <code class="docutils literal notranslate"><span class="pre">L</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code>. Use <span class="math notranslate nohighlight">\(n\)</span> at least three, and preferably larger.</p></li>
<li><p>Compute their product, with <code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">L</span> <span class="pre">&#64;</span> <span class="pre">c</span></code></p></li>
<li><p>Check if <code class="docutils literal notranslate"><span class="pre">c_solution</span> <span class="pre">=</span> <span class="pre">forwardSubstitution(L,</span> <span class="pre">b)</span></code> gives the correct value.</p></li>
</ol>
</div>
<div class="section" id="exercise-2">
<h3><span class="section-number">11.2.6. </span>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this headline">¶</a></h3>
<p>(An ongoing activity.)</p>
<p>Start building a Python module <code class="docutils literal notranslate"><span class="pre">linearalgebra</span></code> in a file <code class="docutils literal notranslate"><span class="pre">linearalgebra.py</span></code>, with all our linear algebra functions: for now, <code class="docutils literal notranslate"><span class="pre">forwardSubstitution(L,</span> <span class="pre">b)</span></code> as above and also <code class="docutils literal notranslate"><span class="pre">rowReduce(A,</span> <span class="pre">b)</span></code> and <code class="docutils literal notranslate"><span class="pre">backwardSubstitution(U,</span> <span class="pre">c)</span></code> from
<a class="reference internal" href="simultaneous-linear-equations-1-row-reduction-python.html"><span class="doc std std-doc">Solving Simultaneous Linear Equations, Part 1</span></a></p>
<p>Include testing/demonstration at the bottom of the module definition file, in the block of the <code class="docutils literal notranslate"><span class="pre">if</span></code> statement</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if __name__ == &quot;__main__&quot;:
</pre></div>
</div>
<p>We will add the Doolittle method and such in a while, and could use this module in assignments and projects.</p>
<div class="section" id="creating-modules">
<h4><span class="section-number">11.2.6.1. </span>Creating modules<a class="headerlink" href="#creating-modules" title="Permalink to this headline">¶</a></h4>
<p>One way to do this is with Spyder (or another Python IDE).
However, if you prefer working primarily with JupyterLab and Jupyter notebooks, one way to create this module is to first put the function <code class="docutils literal notranslate"><span class="pre">def</span></code>’s and testing code in a notebook <code class="docutils literal notranslate"><span class="pre">linearalgebra.ipynb</span></code> and then convert that to <code class="docutils literal notranslate"><span class="pre">linearalgebra.py</span></code> with the JupyerLab menu command</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>File &gt; Export Notebook As ... &gt; Export Notebook to Executable Script
</pre></div>
</div>
<p>As an example of creating a module, I am creating one as we go along in this course, via the notebook
<a class="reference internal" href="numerical_methods_module.html"><span class="doc std std-doc">numerical_methods_module.ipynb</span></a>
and Python code file <code class="docutils literal notranslate"><span class="pre">numerical_methods.py</span></code> derived from that, which defines module <code class="docutils literal notranslate"><span class="pre">numerical_methods</span></code>.</p>
<p>The notebook version is in the Appendices of this Jupyter book.</p>
<p>For MATH 375 students, both this notebook and the derived module file are in the Canvas folder “Notebooks and modules”.</p>
</div>
</div>
</div>
<div class="section" id="when-is-it-safe-to-ignore-pivoting-quite-often-fortunately">
<h2><span class="section-number">11.3. </span>When is it safe to ignore pivoting? Quite often, fortunately.<a class="headerlink" href="#when-is-it-safe-to-ignore-pivoting-quite-often-fortunately" title="Permalink to this headline">¶</a></h2>
<p>Fortunately there are many important cases where we can guarantee that naiave Gaussian elimination will work, and so the LU factorizaton method will too.
At times it can be known in advance that the maximal element pivoting seen in
<a class="reference internal" href="simultaneous-linear-equations-2-pivoting-python.html"><span class="doc std std-doc">Solving Simultaneous Linear Equations, Part 2</span></a>
will never in fact swap rows!</p>
<p>In particular, when solving differential equations, it is often very beneficial to avoid pivoting, and we can often choose an approach that allows this.</p>
<hr class="docutils" />
<p>This work is licensed under <a class="reference external" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="simultaneous-linear-equations-2-pivoting-python.html" title="previous page"><span class="section-number">10. </span>Simultaneous Linear Equations, Part 2: Partial Pivoting</a>
    <a class='right-next' id="next-link" href="simultaneous-linear-equations-4-plu-factorization-python.html" title="next page"><span class="section-number">12. </span>Simultaneous Linear Equations, Part 4: Solving <span class="math notranslate nohighlight">\(Ax = b\)</span> With Both Pivoting and LU factorization</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Brenton LeMesurier, College of Charleston and University of Northern Colorado<br/>
        
            &copy; Copyright 2020–2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>