
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>12. Simultaneous Linear Equations, Part 4: Solving \(Ax = b\) With Both Pivoting and LU factorization &#8212; Elementary Numerical Analysis (with Python)</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="13. Polynomial Collocation (Interpolation/Extrapolation) and Approximation" href="polynomial-collocation%2Bapproximation-python.html" />
    <link rel="prev" title="11. Simultaneous Linear Equations, Part 3: Solving \(Ax = b\) with LU factorization, \(A = L U\)" href="simultaneous-linear-equations-3-lu-factorization-python.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/UNC_BearMascot.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Elementary Numerical Analysis (with Python)</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../preface.html">
   Elementary Numerical Analysis with Python
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Frontmatter
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../plans-for-expansion-improvement.html">
   Full Disclosure: Things I Plan to do to Expand and Improve This Book
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Numerical Analysis
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-by-interval-halving-python.html">
   1. Root Finding by Interval Halving (Bisection)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fixed-point-iteration-python.html">
   2. Solving Equations by Fixed Point Iteration (of Contraction Mappings)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newtons-method-python.html">
   3. Newton’s Method for Solving Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="taylors-theorem.html">
   4. Taylor’s Theorem and the Accuracy of Linearization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error-measures-convergence-rates.html">
   5. Measures of Error and Order of Convergence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newtons-method-convergence-rate.html">
   6. The Convergence Rate of Newton’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-without-derivatives-python.html">
   7. Root-finding Without Derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-1-row-reduction-python.html">
   8. Simultaneous Linear Equations, Part 1: Row Reduction/Gaussian Elimination
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="machine-numbers-rounding-error-and-error-propagation-python.html">
   9. Machine Numbers, Rounding Error and Error Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-2-pivoting-python.html">
   10. Simultaneous Linear Equations, Part 2: Partial Pivoting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-3-lu-factorization-python.html">
   11. Simultaneous Linear Equations, Part 3: Solving
   <span class="math notranslate nohighlight">
    \(Ax = b\)
   </span>
   with LU factorization,
   <span class="math notranslate nohighlight">
    \(A = L U\)
   </span>
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   12. Simultaneous Linear Equations, Part 4: Solving
   <span class="math notranslate nohighlight">
    \(Ax = b\)
   </span>
   With Both Pivoting and LU factorization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polynomial-collocation%2Bapproximation-python.html">
   13. Polynomial Collocation (Interpolation/Extrapolation) and Approximation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polynomial-collocation-error-formulas-python.html">
   14. Error Formulas for Polynomial Collocation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="derivatives-and-the-method-of-undetermined-coefficents.html">
   15. Approximating Derivatives by the Method of Undetermined Coefficients
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="richardson-extrapolation.html">
   16. Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-1-building-blocks-python.html">
   17. Definite Integrals, Part 1: The Building Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-2-composite-rules.html">
   18. Definite Integrals, Part 2: The Composite Trapezoid and Midpoint Rules
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-3-simpson-richardson.html">
   19. Definite Integrals, Part 3: The (Composite) Simpson’s Rule and Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definite-integrals-4-romberg-integration.html">
   20. Definite Integrals, Part 4: Romberg Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-1-basics-and-Euler-python.html">
   21. Initial Value Problems for Ordinary Differential Equations, Part 1: Basic Concepts and Euler’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-2-Runge-Kutta-python.html">
   22. Initial Value Problems for ODEs, Part 2: Runge-Kutta Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-3-error-results-one-step-methods.html">
   23. Initial Value Problems for Ordinary Differential Equations, Part 3: Global Error Bounds for One Step Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-4-system-higher-order-equations.html">
   24. Initial Value Problems for Ordinary Differential Equations, Part 4: Systems of ODEs and Higher Order ODEs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../future_topics.html">
   25. Some Future Topics
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Preliminary Versions of Future Sections
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="ODE-IVP-5-error-control.html">
   1. Initial Value Problems for Ordinary Differential Equations, Part 5: Error Control and Variable Step Sizes — Preview Edition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-5-error-bounds-condition-numbers-python.html">
   2. Simultaneous Linear Equations, Part 5: Error bounds for linear algebra, condition numbers, matrix norms, etc. — Preliminary Version
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Exercises
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-by-interval-halving-exercises-python.html">
   Exercises on the Bisection Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fixed-point-iteration-exercises.html">
   Exercises on Fixed Point Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error-measures-convergence-rates-exercises.html">
   Exercises on Error Measures and Convergence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newtons-method-exercises.html">
   Exercises on Newton’s Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root-finding-without-derivatives-exercises.html">
   Exercises on Root-finding Without Derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="machine-numbers-rounding-error-and-error-propagation-exercises.html">
   Exercises on Machine Numbers, Rounding Error and Error Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simultaneous-linear-equations-exercises.html">
   Exercises on Solving Simultaneous Linear Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="derivatives-and-the-method-of-undetermined-coefficents-exercises.html">
   Exercises on Approximating Derivatives, the Method of Undetermined Coefficients and Richardson Extrapolation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="assignment1.html">
   MATH 375 Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment2.html">
   MATH 375 Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment3.html">
   MATH 375 Assignment 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="root_finding.html">
   Module root_finding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment4.html">
   MATH 375 Assignment 4
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Project on Numerical Calculus
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/tasks-1-and-2-centered-difference-derivative-approximation-and-richardson.html">
   Centered Difference Approximation of the Derivative
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/tasks-1-and-2-centered-difference-derivative-approximation-and-richardson.html#improving-on-the-centered-difference-approximation-with-richardson-extrapolation">
   Improving on the Centered Difference Approximation with Richardson Extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-3-composite-trapezoid-rule.html">
   The Composite Trapezoid Rule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-4-recursive-trapezoid-rule.html">
   The Recursive Trapezoid Rule, with error control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-5-modified-trapezoid-method.html">
   The Modified Trapezoid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-6-modified-trapezoid-without-derivatives.html">
   The Modified Trapezoid Method, without derivatives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/task-7-romberg-method.html">
   The Romberg Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/test-cases-differentiation.html">
   Test Cases for Differentiation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../project-on-numerical-calculus/test-cases-integration.html">
   Test Cases for Integration
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Python and Jupyter Notebook Review (with Numpy and Matplotlib)
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/introduction.html">
   1. Introduction to
   <em>
    Python Preview
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/getting-python-software-for-scientific-computing.html">
   2. Getting Python Software for Scientific Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/suggestions-on-python-and-notebook-usage.html">
   3. Suggestions and Notes on Python and Jupyter Notebook Usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/python-variables-lists-tuples-numpy-arrays.html">
   4. Python Variables, Including Lists and Tuples, and Arrays from Package Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/functions.html">
   5. Defining and Using Python Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/decisions-with-if-else-elif.html">
   6. Decision Making With if, else, and elif
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/iteration-with-for.html">
   7. Iteration with
   <code class="docutils literal notranslate">
    <span class="pre">
     for
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/iteration-with-while.html">
   8. Iteration with
   <code class="docutils literal notranslate">
    <span class="pre">
     while
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/code-files-modules-IDEs.html">
   9. Code Files, Modules, and an Integrated Development Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/recursion.html">
   10. Recursion (vs iteration)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/graphing-with-matplotlib.html">
   11. Plotting Graphs with Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/array-operations-and-linear-algebra.html">
   12. Numpy Array Operations and Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/scipy-tools-for-linear-algebra.html">
   13. Package Scipy and More Tools for Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/summation-and-integration.html">
   14. Summation and Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/random-numbers-and-simulation.html">
   15. Random Numbers, Histograms, and a Simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/formatted-output-and-some-text-string-manipulation.html">
   16. Formatted Output and Some Text String Manipulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/classes-objects-attributes-methods.html">
   17. Classes, Objects, Attributes, Methods: Very Basic Object-Oriented Programming in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_tutorial/exception-handling.html">
   18. Exceptions and Exception Handling
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="numerical_methods_module.html">
   Notebook for generating the module
   <code class="docutils literal notranslate">
    <span class="pre">
     numerical_methods_module
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear-algebra-with-0-based-indexing-and-semiopen-intervals.html">
   Linear algebra algorithms using 0-based indexing and semi-open intervals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sample-project-newtons-method-python-draft.html">
   Numerical Analysis Sample Project on Newtons’s Method
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/simultaneous-linear-equations-4-plu-factorization-python.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/notebooks/simultaneous-linear-equations-4-plu-factorization-python.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   12.1. Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#row-swapping-is-all-you-need">
   12.2. Row swapping is all you need
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-what-happens-at-stage-5-k-5">
     12.2.1. Example: what happens at stage 5 (
     <span class="math notranslate nohighlight">
      \(k=5\)
     </span>
     )?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-general-pattern">
     12.2.2. The general pattern
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pseudo-code-for-lu-factorization-with-row-swapping-first-version">
     12.2.3. Pseudo-code for LU factorization with row swapping (first version)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#but-what-about-the-right-hand-side-b">
     12.2.4. But what about the right-hand side,
     <span class="math notranslate nohighlight">
      \(b\)
     </span>
     ?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pseudo-code-for-lu-factorization-with-a-permutation-vector">
     12.2.5. Pseudo-code for LU factorization with a permutation vector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forward-and-backward-substitution-with-a-permutation-vector">
     12.2.6. Forward and backward substitution with a permutation vector
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="simultaneous-linear-equations-part-4-solving-ax-b-with-both-pivoting-and-lu-factorization">
<h1><span class="section-number">12. </span>Simultaneous Linear Equations, Part 4: Solving <span class="math notranslate nohighlight">\(Ax = b\)</span> With Both Pivoting and LU factorization<a class="headerlink" href="#simultaneous-linear-equations-part-4-solving-ax-b-with-both-pivoting-and-lu-factorization" title="Permalink to this headline">¶</a></h1>
<p><strong>Updated on Wednesday February 17,</strong> with pseudo-code, Python code, and an example.</p>
<p>This work is licensed under <a class="reference external" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a></p>
<hr class="docutils" />
<p><strong>References:</strong></p>
<ul class="simple">
<li><p>Section 2.4 <em>The PA=LU Factorization</em> of <a class="reference external" href="../references.html#Sauer">Sauer</a></p></li>
<li><p>Section 6.5 <em>Matrix Factorizations</em> of <a class="reference external" href="../references.html#Burden-Faires">Burden&amp;Faires</a>, from <em>Permutation Matrices</em> onward.</p></li>
<li><p>Section 8.1 <em>Matrix Factorizations</em> of <a class="reference external" href="../references.html#Chenney-Kincaid">Chenney&amp;Kincaid</a></p></li>
</ul>
<div class="section" id="introduction">
<h2><span class="section-number">12.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The last step in producing an algorithm for solving the general case of <span class="math notranslate nohighlight">\(n\)</span> simultaneous linear equations in <span class="math notranslate nohighlight">\(n\)</span> variables that is <em>robust</em>, <em>efficient</em> and with good control of <em>rounding error</em> is to combine the ideas of <a class="reference internal" href="simultaneous-linear-equations-2-pivoting-python.html"><span class="doc std std-doc">partial pivoting</span></a> (reordering the equations to avoid small pivot elements) and the <a class="reference internal" href="simultaneous-linear-equations-3-lu-factorization-python.html"><span class="doc std std-doc">LU factorization</span></a>.</p>
<p>This is sometimes described in three parts:</p>
<ul class="simple">
<li><p><em>permute</em> (reorder) the rows of the matirx <span class="math notranslate nohighlight">\(A\)</span> by multiplying it at left by a suitable <em>permutation matrix</em> <span class="math notranslate nohighlight">\(P\)</span>; one with a single “1” in each row and each column and zeros elsewhere;</p></li>
<li><p>Get the LU factorization of this matrix: <span class="math notranslate nohighlight">\(PA = LU\)</span>.</p></li>
<li><p>To solve <span class="math notranslate nohighlight">\(A x = b\)</span></p>
<ul>
<li><p>Express as <span class="math notranslate nohighlight">\(P A x = L U x = P b\)</span> (whic just involves computing <span class="math notranslate nohighlight">\(Pb\)</span>, which just reorders the elements of <span class="math notranslate nohighlight">\(b\)</span>)</p></li>
<li><p>Solve <span class="math notranslate nohighlight">\(L c = P b\)</span> for <span class="math notranslate nohighlight">\(c\)</span> by forward substitution</p></li>
<li><p>Solve <span class="math notranslate nohighlight">\(U x = c\)</span> for <span class="math notranslate nohighlight">\(x\)</span> by backward substitution:
as before, this gives <span class="math notranslate nohighlight">\(L U x = L c = P b\)</span> and <span class="math notranslate nohighlight">\(L U x = P A x\)</span>, so <span class="math notranslate nohighlight">\(PAx = Pb\)</span>;
since a permutation matrix <span class="math notranslate nohighlight">\(P\)</span> is invertible (just unravel the row swaps), this ensures that <span class="math notranslate nohighlight">\(Ax = b\)</span>.</p></li>
</ul>
</li>
</ul>
<p>This give anice formuasin terms of matrices; however we can describe it a bit more compactly and efficiently by just talking about the permutation of the rows, described by a <em>permutation vector</em> — an <span class="math notranslate nohighlight">\(n\)</span> component vector
<span class="math notranslate nohighlight">\(\pi = [\pi_1, \pi_2 , \dots, \pi_n]\)</span>
whose elements are the integers from 1 to <span class="math notranslate nohighlight">\(n\)</span> in some order.
So that is how the algorithm will be described below.</p>
<p>(Aside: I use the conventional name <span class="math notranslate nohighlight">\(\pi\)</span> for a permutation vector, partly to distinguish from the notation <span class="math notranslate nohighlight">\(p_i\)</span> used for <em>pivot</em> rows; however, feel free to use the name <span class="math notranslate nohighlight">\(p\)</span> insread, especially in Python code!)</p>
<p>A number of details of this sketch will now be filled in, including the very useful fact that the permutation vector (or matrix) can be contsructed “on the fly”, as rows are swapped in partial pivoting.</p>
</div>
<div class="section" id="row-swapping-is-all-you-need">
<h2><span class="section-number">12.2. </span>Row swapping is all you need<a class="headerlink" href="#row-swapping-is-all-you-need" title="Permalink to this headline">¶</a></h2>
<p>Let us look at maximal element partial pivoting, but described in terms of the entries of the factors <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span>, and updating matrix <span class="math notranslate nohighlight">\(A\)</span> with a succession of row swaps.</p>
<p>(For now, I omit what happens to the right-hand side vector <span class="math notranslate nohighlight">\(b\)</span>; that is where the permutation vecor <span class="math notranslate nohighlight">\(p\)</span> will come in, as addressed below.)</p>
<p>What happens if pivoting occurs at some stage <span class="math notranslate nohighlight">\(k\)</span>, with swapping of row <span class="math notranslate nohighlight">\(k\)</span> with a row <span class="math notranslate nohighlight">\(p_k &gt; 5\)</span>?</p>
<p>One might fear that the process has to start again from the top using the modified version of matrix <span class="math notranslate nohighlight">\(A\)</span>,
but in fact all previous work can be reused, just swapping those rows “everywhere”.</p>
<div class="section" id="example-what-happens-at-stage-5-k-5">
<h3><span class="section-number">12.2.1. </span>Example: what happens at stage 5 (<span class="math notranslate nohighlight">\(k=5\)</span>)?<a class="headerlink" href="#example-what-happens-at-stage-5-k-5" title="Permalink to this headline">¶</a></h3>
<p>To see this with a concrete example consider what happens if at stage <span class="math notranslate nohighlight">\(k=5\)</span> we swap rows 5 and 10 of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>A) Firstly, what happens to matrix <span class="math notranslate nohighlight">\(A\)</span>?</p>
<p>The previous steps of the LU factorization process only involved entries of <span class="math notranslate nohighlight">\(A\)</span> in its first four rows and first four columns, and this row swap has no effect of them.
Likewise, in row reduction, changes at and below row <span class="math notranslate nohighlight">\(k=5\)</span> have no effect on the first four rows of the row reduced form, <span class="math notranslate nohighlight">\(U\)</span>.</p>
<p>Thus, the only change here is to swap the entries of <span class="math notranslate nohighlight">\(A\)</span> between rows 5 and 10.
What is more, the subsequent calculations only involve columns of index <span class="math notranslate nohighlight">\(j=5\)</span> upwards,
so in fact we only need to update those entries.
This can be written as</p>
<div class="math notranslate nohighlight">
\[ a_{5, j} \leftrightarrow a_{10, j}, \quad 5 \leq j \leq n \]</div>
<p>Thus if we are working in Python with <span class="math notranslate nohighlight">\(A\)</span> stored in a numpy array, the update is the slice operation</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>( A[5, 5:], A[10, 5:] ) = ( A[10, 5:], A[5, 5:] ) 
</pre></div>
</div>
<p>(except for that pesky Pythonic down-shifting of indices; to be seen in pseudo-code later!)</p>
<p>B) Next, look at the work done so far on <span class="math notranslate nohighlight">\(U\)</span>.</p>
<p>That just consists of the previous rows <span class="math notranslate nohighlight">\(1 \leq i \leq 4\)</span>, and the swapping of rows 5 with 10 has no effect up there:</p>
<p><em>Values already computed in <span class="math notranslate nohighlight">\(U\)</span> are unchanged.</em></p>
<p>C) Finally, look at the work done so far on the multipiers <span class="math notranslate nohighlight">\(l_{i,j}\)</span>; that is, matrix <span class="math notranslate nohighlight">\(L\)</span>.</p>
<p>The values computed so far are the first four columns of <span class="math notranslate nohighlight">\(L\)</span>;
the multiples <span class="math notranslate nohighlight">\(l_{i,j}\)</span>, <span class="math notranslate nohighlight">\(1 \leq j \leq 4\)</span> of row <span class="math notranslate nohighlight">\(j\)</span> subtracted from row <span class="math notranslate nohighlight">\(i &gt; j\)</span>.
These <em>do</em> change: for example, the multiple <span class="math notranslate nohighlight">\(l_{5,2}\)</span> of row <span class="math notranslate nohighlight">\(2\)</span> is now subtracted from what was row 5 but is now row 10: thus, the new value of <span class="math notranslate nohighlight">\(l_{10,2}\)</span> is the previous value of <span class="math notranslate nohighlight">\(l_{5,2}\)</span>.</p>
<p>Likewise, the same is true in reverse: the new value of <span class="math notranslate nohighlight">\(l_{5,2}\)</span> is the previous value of <span class="math notranslate nohighlight">\(l_{10,2}\)</span>.
This applies for all of the first four rows, so second index <span class="math notranslate nohighlight">\(1 \leq j \leq 4\)</span>:</p>
<p><em>The entries of <span class="math notranslate nohighlight">\(L\)</span> computed so far are swapped between rows 5 and 10, leaving the rest unchanged.</em></p>
<p>As this is again only for some columns — the first four — the swaps needed are:</p>
<div class="math notranslate nohighlight">
\[ l_{5, j} \leftrightarrow l_{10, j}, \quad 1 \leq j \leq 4 \]</div>
<p>or in Python slice notation for an array <span class="math notranslate nohighlight">\(L\)</span>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>( L[5, :4], L[10, :4] ) = ( L[10, :4], L[5, :4] )
</pre></div>
</div>
</div>
<div class="section" id="the-general-pattern">
<h3><span class="section-number">12.2.2. </span>The general pattern<a class="headerlink" href="#the-general-pattern" title="Permalink to this headline">¶</a></h3>
<p>The example above extends to all stages <span class="math notranslate nohighlight">\(k\)</span> of row reduction or computing the LU factorization or a permute versio of matrix <span class="math notranslate nohighlight">\(A\)</span>, where we adjust the pivot element at position <span class="math notranslate nohighlight">\((k, k)\)</span> by first swapping row <span class="math notranslate nohighlight">\(k\)</span> with a row <span class="math notranslate nohighlight">\(p_k, \geq k\)</span>.
(Allowing that sometimes no swap is needed, so that <span class="math notranslate nohighlight">\(p_k = k\)</span>.)</p>
<p>Gathering the key formulas above, this part of the algorithm is</p>
<p>for k from 1 to n-1:
<br>
<span class="math notranslate nohighlight">\(\quad\)</span> Find the pivot row <span class="math notranslate nohighlight">\(p_k, \geq k\)</span>.
<br>
<span class="math notranslate nohighlight">\(\quad\)</span> if <span class="math notranslate nohighlight">\(p_k &gt; k\)</span>:
<br>
<span class="math notranslate nohighlight">\(\quad\quad\)</span> Swap <span class="math notranslate nohighlight">\(l_{k, j} \leftrightarrow l_{p_k, j}, \quad 1 \leq j &lt; k \)</span>
<br>
<span class="math notranslate nohighlight">\(\quad\quad\)</span> Swap <span class="math notranslate nohighlight">\(a_{k, j} \leftrightarrow a_{p_k, j}, \quad k \leq j \leq n \)</span>
<br>
<span class="math notranslate nohighlight">\(\quad\)</span> end for
<br>
end for</p>
</div>
<div class="section" id="pseudo-code-for-lu-factorization-with-row-swapping-first-version">
<h3><span class="section-number">12.2.3. </span>Pseudo-code for LU factorization with row swapping (first version)<a class="headerlink" href="#pseudo-code-for-lu-factorization-with-row-swapping-first-version" title="Permalink to this headline">¶</a></h3>
<p>Here I also adopt slice notation; for example, <span class="math notranslate nohighlight">\(a_{k, k:n}\)</span> denotes the slice <span class="math notranslate nohighlight">\([a_{k, k} \dots a_{k, n}]\)</span>.</p>
<p>for k from 1 to n
<br><span class="math notranslate nohighlight">\(\quad\)</span> <em>Find the pivot element:</em>
<br><span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(p = k\)</span>  <span class="math notranslate nohighlight">\(\quad\)</span> <em>(p will be the index of the pivot row)</em>
<br><span class="math notranslate nohighlight">\(\quad\)</span> for i from k+1 to n:
<br><span class="math notranslate nohighlight">\(\quad\)</span><span class="math notranslate nohighlight">\(\quad\)</span> if |u_{i, k}| &gt; |u_{p, k}|:
<br><span class="math notranslate nohighlight">\(\quad\)</span><span class="math notranslate nohighlight">\(\quad\)</span><span class="math notranslate nohighlight">\(\quad\)</span> p = i
<br><span class="math notranslate nohighlight">\(\quad\)</span><span class="math notranslate nohighlight">\(\quad\)</span> end if
<br><span class="math notranslate nohighlight">\(\quad\)</span> end for
<br><span class="math notranslate nohighlight">\(\quad\)</span> if p &gt; k: <span class="math notranslate nohighlight">\(\quad\)</span> <em>(Swap rows)</em>
<br><span class="math notranslate nohighlight">\(\quad\)</span><span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(l_{k, 1:k-1} \leftrightarrow l_{p, 1:k-1}\)</span>
<br><span class="math notranslate nohighlight">\(\quad\)</span><span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(a_{k, k:n} \leftrightarrow a_{p, k:n}\)</span>
<br><span class="math notranslate nohighlight">\(\quad\)</span> end if
<br><span class="math notranslate nohighlight">\(\quad\)</span> for j from k to n: <span class="math notranslate nohighlight">\(\quad\)</span> <em>(Get the non-zero elements in row <span class="math notranslate nohighlight">\(k\)</span> of <span class="math notranslate nohighlight">\(U\)</span>)</em>
<br><span class="math notranslate nohighlight">\(\quad\quad\)</span> <span class="math notranslate nohighlight">\(u_{k,j}=a_{k,j}-\sum_{s=1}^{k-1}l_{k,s}u_{s,j}\)</span>
<br><span class="math notranslate nohighlight">\(\quad\)</span> end for
<br><span class="math notranslate nohighlight">\(\quad\)</span> for i from k+1 to n <span class="math notranslate nohighlight">\(\quad\)</span> <em>(Get the non-zero elements in column <span class="math notranslate nohighlight">\(k\)</span> of <span class="math notranslate nohighlight">\(L\)</span> — except the 1’s on its diagonal)</em>
<br><span class="math notranslate nohighlight">\(\quad\quad\)</span> <span class="math notranslate nohighlight">\(l_{i,k}=\displaystyle\frac{a_{i,k}-\sum_{s=1}^{k-1}l_{i,s}u_{s,k}}{u_{k,k}}\)</span>
<br><span class="math notranslate nohighlight">\(\quad\)</span> end for
<br>end for</p>
</div>
<div class="section" id="but-what-about-the-right-hand-side-b">
<h3><span class="section-number">12.2.4. </span>But what about the right-hand side, <span class="math notranslate nohighlight">\(b\)</span>?<a class="headerlink" href="#but-what-about-the-right-hand-side-b" title="Permalink to this headline">¶</a></h3>
<p>One thing is missing from this strategy so far:
if we are solving with a given right-hand-side column vector <span class="math notranslate nohighlight">\(b\)</span>, we would also swap its rows at each stage, with</p>
<div class="math notranslate nohighlight">
\[ b_k \leftrightarrow b_{p_k} \]</div>
<p>but with the LU factorization we need to keep track of these swaps for use later.</p>
<p>This turns out to mesh nicely with another detail: we can avoid actually copying array entries around by just keeping track of the order in which we use rows to get zeros in other rows.
Our goal will be a permutation vector <span class="math notranslate nohighlight">\(\pi = [\pi_1, \pi_2, \dots \pi_n]\)</span> which says:</p>
<ul class="simple">
<li><p>First use row <span class="math notranslate nohighlight">\(\pi_1\)</span> to get zeros in column 1 of the <span class="math notranslate nohighlight">\(n-1\)</span> other rows.</p></li>
<li><p>Then use row <span class="math notranslate nohighlight">\(\pi_2\)</span> to get zeros in column 2 of the <span class="math notranslate nohighlight">\(n-2\)</span> remaining rows.</p></li>
<li><p>…</p></li>
</ul>
<p>To do this:</p>
<ul class="simple">
<li><p>first, initialize an array <span class="math notranslate nohighlight">\(\pi = [1, 2, \dots, n]\)</span></p></li>
<li><p>at stage <span class="math notranslate nohighlight">\(k\)</span>, if the pivot element is in row <span class="math notranslate nohighlight">\(p_k \neq k\)</span>, swap the corresponding elements in <span class="math notranslate nohighlight">\(\pi\)</span>
(rather than swapping entire rows of arrays):</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\pi_k \leftrightarrow \pi_{p_k}\]</div>
<p>Introducing the name <span class="math notranslate nohighlight">\(A'\)</span> for the new version of matrix <span class="math notranslate nohighlight">\(A\)</span>,
its row <span class="math notranslate nohighlight">\(k\)</span> has entries <span class="math notranslate nohighlight">\(a'_{k, j} = a_{\pi_k, j}\)</span>.</p>
<p>This pattern persists through each row swap: instead of computing a succesion of updated versions of matrix <span class="math notranslate nohighlight">\(A\)</span>,
we leave it alone and just change the row indices:</p>
<p><em>All references to entries of <span class="math notranslate nohighlight">\(A\)</span> are now done with permuted row index: <span class="math notranslate nohighlight">\(a_{\pi_i, j}\)</span></em></p>
<p>The same applies to the array <span class="math notranslate nohighlight">\(L\)</span> of multipliers:</p>
<p><em>All references to entries of <span class="math notranslate nohighlight">\(L\)</span> are now done with <span class="math notranslate nohighlight">\(l_{\pi_i, j}\)</span></em>.</p>
<p>Finally, since these row swaps also apply to the right-hand side <span class="math notranslate nohighlight">\(b\)</span>, we do the same there:</p>
<p><em>All references to entries of <span class="math notranslate nohighlight">\(b\)</span> are now done with <span class="math notranslate nohighlight">\(b_{\pi_i}\)</span></em>.</p>
</div>
<div class="section" id="pseudo-code-for-lu-factorization-with-a-permutation-vector">
<h3><span class="section-number">12.2.5. </span>Pseudo-code for LU factorization with a permutation vector<a class="headerlink" href="#pseudo-code-for-lu-factorization-with-a-permutation-vector" title="Permalink to this headline">¶</a></h3>
<p><em>Initialize the permutation vector,</em> <span class="math notranslate nohighlight">\(\pi \leftarrow [1, 2, \dots, n]\)</span></p>
<p>for k from 1 to n
<br><span class="math notranslate nohighlight">\(\quad\)</span> <em>Find the pivot element:</em>
<br><span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(p \leftarrow k\)</span>  <span class="math notranslate nohighlight">\(\quad\)</span> <em>(p will be the index of the pivot row)</em>
<br><span class="math notranslate nohighlight">\(\quad\)</span> for i from k+1 to n:
<br><span class="math notranslate nohighlight">\(\quad\)</span><span class="math notranslate nohighlight">\(\quad\)</span> if <span class="math notranslate nohighlight">\(|u_{i, k}| &gt; |u_{p, k}|\)</span>:
<br><span class="math notranslate nohighlight">\(\quad\)</span><span class="math notranslate nohighlight">\(\quad\)</span><span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(p \leftarrow i\)</span>
<br><span class="math notranslate nohighlight">\(\quad\)</span><span class="math notranslate nohighlight">\(\quad\)</span> end if
<br><span class="math notranslate nohighlight">\(\quad\)</span> if p &gt; k: <span class="math notranslate nohighlight">\(\quad\)</span> <em>(Just swap indices, not rows)</em>
<br><span class="math notranslate nohighlight">\(\quad\)</span><span class="math notranslate nohighlight">\(\quad\)</span> <span class="math notranslate nohighlight">\(\pi_k \leftrightarrow \pi_p\)</span>
<br><span class="math notranslate nohighlight">\(\quad\)</span> end if
<br><span class="math notranslate nohighlight">\(\quad\)</span> for j from k to n: <span class="math notranslate nohighlight">\(\quad\)</span> <em>(Get the non-zero elements in row <span class="math notranslate nohighlight">\(k\)</span> of <span class="math notranslate nohighlight">\(U\)</span>)</em>
<br><span class="math notranslate nohighlight">\(\quad\quad\)</span> <span class="math notranslate nohighlight">\(u_{k,j} \leftarrow a_{k,j}-\sum_{s=1}^{k-1}l_{k,s}u_{s,j}\)</span>
<br><span class="math notranslate nohighlight">\(\quad\)</span> end for
<br><span class="math notranslate nohighlight">\(\quad\)</span> for i from k+1 to n: <span class="math notranslate nohighlight">\(\quad\)</span> <em>(Get the non-zero elements in column <span class="math notranslate nohighlight">\(k\)</span> of <span class="math notranslate nohighlight">\(L\)</span> — except the 1’s on its diagonal)</em>
<br><span class="math notranslate nohighlight">\(\quad\quad\)</span> <span class="math notranslate nohighlight">\(l_{i,k} \leftarrow \displaystyle\frac{a_{i,k}-\sum_{s=1}^{k-1}l_{i,s}u_{s,k}}{u_{k,k}}\)</span>
<br><span class="math notranslate nohighlight">\(\quad\)</span> end for
<br>end for</p>
<p><strong>Aside:</strong> For the version with a permutation matrix <span class="math notranslate nohighlight">\(P\)</span>, instead:</p>
<ul class="simple">
<li><p>start with an array <span class="math notranslate nohighlight">\(P\)</span> that is the identity matrix, and then</p></li>
<li><p>swap its rows <span class="math notranslate nohighlight">\(k \leftrightarrow p_k\)</span> at stage <span class="math notranslate nohighlight">\(k\)</span> instead of swapping the entries of <span class="math notranslate nohighlight">\(\pi\)</span> or the rows of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(L\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">zeros_like</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plu</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">demoMode</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the Doolittle PA=LU factorization of A —</span>
<span class="sd">    but with the permutation recorded as permutation vector, not as the permutation matrix P.</span>
<span class="sd">    Sums like $\sum_{s=1}^{k-1} l_{k,s} u_{s,j}$ are done as matrix products;</span>
<span class="sd">    in the above case, row matrix L[k, 1:k-1] by column matrix U[1:k-1,j] gives the sum for a give j,</span>
<span class="sd">    and row matrix L[k, 1:k-1] by matrix U[1:k-1,k:n] gives the relevant row vector.</span>
<span class="sd">    </span>
<span class="sd">    NOT WORKING YET!</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>  <span class="c1"># len() gives the number of rows in a 2D array.</span>
    <span class="n">perm</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="c1"># Initialize U as the zero matrix;</span>
    <span class="c1"># correct below the main diagonal, with the other entries to be computed below.</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">zeros_like</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="c1"># Also, initialize L as the zero matrix;</span>
    <span class="c1"># the 1&#39;s will also be filled in as we go.</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">zeros_like</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">demoMode</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Find the pivot element in column k:</span>
        <span class="n">pivot_row</span> <span class="o">=</span> <span class="n">k</span>
        <span class="n">abs_u_ik_max</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">k</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">abs_u_ik</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">row</span><span class="p">],</span><span class="n">k</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">abs_u_ik</span> <span class="o">&gt;</span> <span class="n">abs_u_ik_max</span><span class="p">:</span>
                <span class="n">pivot_row</span> <span class="o">=</span> <span class="n">row</span>
                <span class="n">abs_u_ik_max</span> <span class="o">=</span> <span class="n">abs_u_ik</span>
        <span class="k">if</span> <span class="n">pivot_row</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span> <span class="c1"># &quot;swap&quot;</span>
            <span class="k">if</span> <span class="n">demoMode</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Swap row </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> with row </span><span class="si">{</span><span class="n">pivot_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">pivot_row</span><span class="p">])</span> <span class="o">=</span> <span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="n">pivot_row</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">demoMode</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No row swap needed.&quot;</span><span class="p">)</span>
        <span class="n">U</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">:]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">k</span><span class="p">:]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">k</span><span class="p">],:</span><span class="n">k</span><span class="p">]</span> <span class="o">@</span> <span class="n">U</span><span class="p">[:</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">:]</span>
        <span class="n">L</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span> 
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">L</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">row</span><span class="p">],</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">A</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">row</span><span class="p">],</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">row</span><span class="p">],:</span><span class="n">k</span><span class="p">]</span> <span class="o">@</span> <span class="n">U</span><span class="p">[:</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">U</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">demoMode</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;permuted A is:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">row</span><span class="p">],:])</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;intermediate U is</span><span class="se">\n</span><span class="si">{</span><span class="n">U</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;intermediate L is</span><span class="se">\n</span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;perm=</span><span class="si">{</span><span class="n">perm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># The last row (index &quot;-1&quot;) is special: nothing to do for L except put in the 1 on the &quot;permuted main diagonal&quot;</span>
    <span class="n">U</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">U</span><span class="p">[:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">L</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span> 
    <span class="k">if</span> <span class="n">demoMode</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;After the final step, k=</span><span class="si">{</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;U=</span><span class="se">\n</span><span class="si">{</span><span class="n">U</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">perm</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mf">1.</span> <span class="p">,</span> <span class="o">-</span><span class="mf">3.</span> <span class="p">,</span> <span class="mf">22.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.</span> <span class="p">,</span> <span class="mf">5.</span> <span class="p">,</span> <span class="o">-</span><span class="mf">6.</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.</span> <span class="p">,</span> <span class="mf">235.</span> <span class="p">,</span> <span class="mf">7.</span><span class="p">],</span> <span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A=</span><span class="se">\n</span><span class="si">{</span><span class="n">A</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">perm</span><span class="p">)</span> <span class="o">=</span> <span class="n">plu</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">demoMode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Function plu gives&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;row permution </span><span class="si">{</span><span class="n">perm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L=</span><span class="se">\n</span><span class="si">{</span><span class="n">L</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;U=</span><span class="se">\n</span><span class="si">{</span><span class="n">U</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The &#39;residual&#39; A - LU is </span><span class="se">\n</span><span class="si">{</span><span class="n">A</span> <span class="o">-</span> <span class="n">L</span><span class="nd">@U</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A=
[[  1.  -3.  22.]
 [  3.   5.  -6.]
 [  4. 235.   7.]]
k=0
Swap row 0 with row 2
permuted A is:
[  4. 235.   7.]
[ 3.  5. -6.]
[ 1. -3. 22.]
intermediate U is
[[  4. 235.   7.]
 [  0.   0.   0.]
 [  0.   0.   0.]]
intermediate L is
[[0.25 0.   0.  ]
 [0.75 0.   0.  ]
 [1.   0.   0.  ]]
perm=[2 1 0]
k=1
No row swap needed.
permuted A is:
[  4. 235.   7.]
[ 3.  5. -6.]
[ 1. -3. 22.]
intermediate U is
[[   4.    235.      7.  ]
 [   0.   -171.25  -11.25]
 [   0.      0.      0.  ]]
intermediate L is
[[0.25       0.36058394 0.        ]
 [0.75       1.         0.        ]
 [1.         0.         0.        ]]
perm=[2 1 0]
After the final step, k=2
U=
[[   4.          235.            7.        ]
 [   0.         -171.25        -11.25      ]
 [   0.            0.           24.30656934]]

Function plu gives
row permution [2 1 0]
L=
[[0.25       0.36058394 1.        ]
 [0.75       1.         0.        ]
 [1.         0.         0.        ]]
U=
[[   4.          235.            7.        ]
 [   0.         -171.25        -11.25      ]
 [   0.            0.           24.30656934]]
The &#39;residual&#39; A - LU is 
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
</pre></div>
</div>
</div>
</div>
<p>Matrix <span class="math notranslate nohighlight">\(L\)</span> is not actually lower triangular, due to the permutation of its rows,
but is still fine for a version of forward substition, because</p>
<ul class="simple">
<li><p>row <span class="math notranslate nohighlight">\(\pi_1\)</span> only involves <span class="math notranslate nohighlight">\(x_1\)</span> (multiplied by 1) and so can be used to solve for <span class="math notranslate nohighlight">\(x_1\)</span></p></li>
<li><p>row <span class="math notranslate nohighlight">\(\pi_2\)</span> only involves <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> (the latter multiplied by 1) and so can be used to solve for <span class="math notranslate nohighlight">\(x_2\)</span></p></li>
<li><p>…</p></li>
</ul>
<p><strong>Aside:</strong> Such a matrix is called <em>psychologically lower triangular</em> — maybe because it believes itself to be such?</p>
</div>
<div class="section" id="forward-and-backward-substitution-with-a-permutation-vector">
<h3><span class="section-number">12.2.6. </span>Forward and backward substitution with a permutation vector<a class="headerlink" href="#forward-and-backward-substitution-with-a-permutation-vector" title="Permalink to this headline">¶</a></h3>
<p>To solve <span class="math notranslate nohighlight">\(L c = b\)</span>, all one has to change from the formulas for forward substitution seen in the previous section on
<a class="reference internal" href="simultaneous-linear-equations-3-lu-factorization-python.html"><span class="doc std std-doc">the LU factorization</span></a>
is to put the permuted row index <span class="math notranslate nohighlight">\(\pi_i\)</span> in both <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(b\)</span>:</p>
<div class="math notranslate nohighlight">
\[ c_i = b_{\pi_i} - \sum_{j=1}^{i-1} l_{\pi_i,j} c_j,\; 1 \leq i \leq n \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">forwardSubstitution</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">perm</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solve L c = b for c, ith permutation of the rows of L and of b.&quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">zeros_like</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">:</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">c</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;b = </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b = [2. 3. 4.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">forwardSubstitution</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">perm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;c=</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c=[4. 0. 1.]
</pre></div>
</div>
</div>
</div>
<p>Then the final step, solving <span class="math notranslate nohighlight">\(Ux = b\)</span> for <span class="math notranslate nohighlight">\(x\)</span>, needs no change, because <span class="math notranslate nohighlight">\(U\)</span> had no rows swapped,
so we are done; we can import the function <code class="docutils literal notranslate"><span class="pre">backwardSubstitution</span></code> seen previously</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numerical_methods_module</span> <span class="kn">import</span> <span class="n">backwardSubstitution</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">backwardSubstitution</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x=</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">A</span><span class="nd">@x</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The residual r = b - Ax is </span><span class="se">\n</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">, with maximum norm </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">r</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x=[ 1.08678679 -0.0027027   0.04114114]
The residual r = b - Ax is 
[0. 0. 0.], with maximum norm 0.0
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>This work is licensed under <a class="reference external" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a></p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="simultaneous-linear-equations-3-lu-factorization-python.html" title="previous page"><span class="section-number">11. </span>Simultaneous Linear Equations, Part 3: Solving <span class="math notranslate nohighlight">\(Ax = b\)</span> with LU factorization, <span class="math notranslate nohighlight">\(A = L U\)</span></a>
    <a class='right-next' id="next-link" href="polynomial-collocation%2Bapproximation-python.html" title="next page"><span class="section-number">13. </span>Polynomial Collocation (Interpolation/Extrapolation) and Approximation</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Brenton LeMesurier, College of Charleston and University of Northern Colorado<br/>
        
            &copy; Copyright 2020–2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>